<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>hpng</title>
  
  
  <link href="http://nikohpng.github.io/atom.xml" rel="self"/>
  
  <link href="http://nikohpng.github.io/"/>
  <updated>2024-01-28T09:41:48.446Z</updated>
  <id>http://nikohpng.github.io/</id>
  
  <author>
    <name>hpng</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>阅读SIP协议观后感</title>
    <link href="http://nikohpng.github.io/2024/01/01/freeswitch/%E9%98%85%E8%AF%BBSIP%E5%8D%8F%E8%AE%AE%E8%A7%82%E5%90%8E%E6%84%9F/"/>
    <id>http://nikohpng.github.io/2024/01/01/freeswitch/%E9%98%85%E8%AF%BBSIP%E5%8D%8F%E8%AE%AE%E8%A7%82%E5%90%8E%E6%84%9F/</id>
    <published>2024-01-01T03:25:57.000Z</published>
    <updated>2024-01-28T09:41:48.446Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文主要记录阅读 SIP rfc3261 文档的一些所思所考，不会对其进行整理分类，并且存在跳跃性</p><h2 id="生成-SIP-响应"><a href="#生成-SIP-响应" class="headerlink" title="生成 SIP 响应"></a>生成 SIP 响应</h2><ul><li>8.2.6</li><li>除了 invite 外需要生成临时响应，其它响应应该立即响应</li><li>生成的临时响应，请求中的时间戳应该直接复制到响应中。如果响应慢就需要将延迟时间以 s 为单位，将时间生成在响应中</li><li>响应的 Call-ID、CSeq、VIA的顺序必须相同。除了 100，其它响应的 uri 内容必须相同，并且需要添加一个 tag，用于 dialog。</li></ul><h2 id="事务的解读"><a href="#事务的解读" class="headerlink" title="事务的解读"></a>事务的解读</h2><p>事务的分为客户端事务与服务器事务，客户端事务发送请求，服务器事务发送响应。</p><p>无状态代理不包含客户端事务或服务器事务。</p><ul><li>200(Ok)的ack作用：主要为了确保 200ok 能够正常发送到 UAC。如果后续不发送 ACK，那么服务端会不断发送，并且在三分钟后断开连接<ul><li>疑问：为啥 200 ok 的 ack 作为自己单独的事务？</li><li>解答：这样设计的原因是保证送达到UAC，并且如果没有回复 ACK，那么 UAS 将会重传</li></ul></li><li>客户端事务：客户端事务的主要负责将接收到的响应传递给 TU, 并过滤重传与不允许的传递。对于 invite 的请求，用于生成 ACK<ul><li>疑问：TU 与客户端事务有什么区别吗</li><li>解答：客户端是TU 与 传输层的中间层</li></ul></li><li>服务器事务：服务器事务的目的是接收来自传输层的请求并将其传递给TU，服务器事务过滤来自网络的任何请求重传。<br>服务器事务接受来自TU的响应，并将它们传递到传输层，以便通过网络进行传输。在INVITE事务的情况下，它会吸收除2xx响应之外的任何最终响应的ACK请求。</li><li>200ok与ack的生成： 都由 UA 核心来处理<ul><li>疑问：前面说客户端事务生成ack,现在又说 UA 核心来处理，不明白</li><li>解释：这里的由核心来处理指的是重传由核心处理。</li></ul></li><li>on-INVITE client transaction：这是没有 ack 的事务。如果需要 ack 的话，需要 tu 直接生成一个 ack?</li></ul><h3 id="客户端事务"><a href="#客户端事务" class="headerlink" title="客户端事务"></a>客户端事务</h3><ul><li>客户端事务状态机： invite 客户端事务与非 invite 客户端事务<ul><li>特点：invite 客户端事务发送延迟长，需要三方握手；非 invite 事务需要立即响应</li><li>注意：如果 TU 希望发送 ACK，它将一个 ACK 直接传递给传输层进行传输</li></ul></li></ul><h4 id="invite-客户端事务"><a href="#invite-客户端事务" class="headerlink" title="invite 客户端事务"></a>invite 客户端事务</h4><p>invite 事务由发送 invite、服务器事务响应、客户端事务响应ack组成。<br>其中 invite 发出后在 t1（默认值：500ms） 重发，除非接受到 1xx 响应，否则就增加两倍的 t1 进行重传。<br>最终，服务器事务发出最终响应，并有客户端事务发送 ack 用于终止重传</p><ul><li>形式描述<ul><li>invite 的客户端事务初始状态为 “Calling”<ul><li>不可靠传输启动定时器 A(t1)，可靠传输不需要启动。事务启动定时器 B(64*t1) 控制事务超时</li><li>超时后重传必须在 “calling” 状态下进行，并且传输时间是 2*t1</li><li>如果定时器 B 触发后任然处于 “calling”, 则通知 TU 超时，并不生成 ack，然后进入 “Terminated” 状态</li></ul></li><li>当接收到临时响应是，状态改为 “Proceeding”。后续的临时响应需要传递给 TU<ul><li>当处于 “Calling” 或 “Proceeding” 状态下，接收到 300-699 响应必须转换为 “Completed”</li><li>接收到服务器事务的响应后，生成 ack 并传输到原始请求发送到的相同的地址、端口和 transport</li><li>当进入 “Completed” 时，启动定时器 D, 对于不可靠传输值至少为 32 秒，可靠传输置为 0。这个值等于服务器事务定时器 H(64*T1)</li><li>新接收到的重新响应不能传递给 TU</li></ul></li><li>定时器 D 在客户端事务处于 “Completed” 状态时触发，客户端事务必须移动到 “Terminated”<ul><li>当处于 “Calling” 或 “Proceeding” 状态下，接收 2xx 响应必须导致客户端事务进入 “Terminated” 状态，并且必须将响应传递到TU</li><li>Proxy 响应 200 为传递给下一跳，客户端事务生成 ack</li><li>客户端事务必须在进入 “Terminated” 状态的瞬间被销毁。</li><li>注意：如何没匹配到合适的客户端事务，则传递到 core</li></ul></li></ul></li><li>ack 的构造<ul><li>Call-ID、From 和 Request-URI 必须和原始请求相同</li><li>To 必须等于被确定的响应中的 To 字段</li><li>ACK 必须包含单一的 Via 报头字段，这个字段必须等于原始的顶部 Via 报头字段</li><li>如果 2xx 中有 Route 字段，则这些也要出现在 ACK 报头中</li><li>注意：invite 响应 415，则可以在 ACK 中放置 body 内容</li></ul></li></ul><h4 id="非-INVITE-客户端事务"><a href="#非-INVITE-客户端事务" class="headerlink" title="非 INVITE 客户端事务"></a>非 INVITE 客户端事务</h4><p>非 INVITE 客户端事务超时 t1 后重传，但是在接受到临时或最终响应后，以 t2 为间隔继续传输消息。</p><blockquote><p>疑问：按照标准文档，按照 t2 继续传输消息，是为了确保交付最后响应。服务器发送了一个请求后，传输在终止？</p></blockquote><p>非 INVITE 客户端事务的 200ok 不会响应 ACK。</p><ul><li>形式描述：<ul><li>发起事务请求，进入 “Trying” 状态<ul><li>启动定时器 F(64<em>T1) 。如果是不可靠传输，客户端事务必须设置定时器 E(T1)，以MIN(2</em>T1,T2)，T2 默认为 4s</li><li>如果定时器 F 触发，仍处于 “Trying”，通知 TU 超时，然后进入 “Terminated” 状态</li><li>如果在 “Trying” 状态下收到最终响应(200-699)，则传递给 TU，事务转换为 “Completed” 状态</li></ul></li><li>当在 “Trying” 状态下收到临时响应，则转为 “Proceeding” 状态<ul><li>如果定时器 E 在 “Proceeding” 状态下被触发，请求需要被重传，定时器 E 重置为 T2 秒</li><li>如果定时器 F 在 “Proceeding” 状态下被触发，通知 TU 超时，然后进入 “Terminated” 状态</li><li>如果在 “Proceeding” 状态下收到最终响应(200-699)，则传递给 TU，事务转换为 “Completed” 状态</li></ul></li><li>当进入 “Completed” 时，启动定时器 K, 对于不可靠传输值 T4 秒，可靠传输置为 0。<ul><li>T4表示网络清除客户机和服务器事务之间的消息所需的时间。缺省值为5s</li><li>如果定时器 K 在此状态下触发，客户端事务必须转换到 “Terminated” 状态。</li></ul></li></ul></li><li>匹配响应给对应客户端事务<ul><li>响应消息的 Via 头字段的 Branch 参数相同，则匹配</li><li>CSeq报头字段中的方法参数与创建事务的请求的方法匹配。用于 CANCEL，CANCEL 会新生成一个事务</li></ul></li><li>异常处理<ul><li>当传输发送错误时，立即想 TU 响应错误，并直接切换到 “Terminated” 状态</li></ul></li></ul><h3 id="服务器事务"><a href="#服务器事务" class="headerlink" title="服务器事务"></a>服务器事务</h3><p>服务器事务是在接收到请求时由核心创建。</p><h4 id="INVITE-服务器事务"><a href="#INVITE-服务器事务" class="headerlink" title="INVITE 服务器事务"></a>INVITE 服务器事务</h4><ul><li><p>形式描述：</p><ul><li><p>Proceeding 收到重传请求，那么需要获取 TU 给的最新的 trying 进行重传</p><ul><li>Proceeding 状态下 TU 向服务器事务传递 2xx 响应，服务器事务必须传出去，当然重传由 TU 负责，服务器事务状态转为 Terminated</li><li>Proceeding 状态下 TU 向服务器事务传递 300-699，必须传出去，服务器事务状态转为 Completed。不可靠传输定时器 G(T1) 触发，可靠传输，定时器不触发。</li></ul></li><li><p>Completed 进入后，定时器 H(64*T1) 必须启动，此定时器决定了重传超时时间。</p><ul><li>如果定时器 G 触发，则将继续重传，定时器 G 时间为  MIN(2*T1, T2)</li><li>Completed 状态下，接收到重传请求应该进行重传</li><li>Completed 状态下，收到了 ACK，则转为 Confirmed。并且定时器 G 被忽略，任何重传都会停止</li><li>Completed 状态下，定时器 H 被激活，则服务器事务转为 Terminated 状态，并通知 TU 事务失败。</li></ul></li><li><p>Confirmed 主要用于吸收多余的 ACK。</p><ul><li>当进入该状态时，定时器 I 在 T4 秒内触发，对于不可靠的传输，定时器 I 为 0 秒。</li><li>一旦定时器触发，则转为 Terminated 状态</li></ul></li><li><p>一旦事务处于“终止”状态，它必须立即销毁。与客户端事务一样，这需要确保对INVITE的2xx响应的可靠性。</p></li></ul></li></ul><h4 id="非-INVITE-服务器事务"><a href="#非-INVITE-服务器事务" class="headerlink" title="非 INVITE 服务器事务"></a>非 INVITE 服务器事务</h4><ul><li>形式描述：<ul><li>Trying 状态下，初始化走这个状态并且任何重传都将丢弃<ul><li>TU 向服务器事务传输响应，则转为 Proceeding 状态</li></ul></li><li>Proceeding 状态下，所有 TU 传输过来的内容，都需要全部通过传输层传输出去<ul><li>Proceeding 接收到请求的重传，则必须将最新发送临时响应重传出去</li><li>Proceeding 状态下，TU 向服务器事务传递最终响应(200-699), 则事务必须进入 Completed 状态</li></ul></li><li>Completed 状态必须启动定时器 J（64*T1），不可靠为 0 秒<ul><li>TU 传递给服务器事务的任何其他最终响应必须在处于 Completed 状态时丢弃</li><li>服务器事务保持这个状态，直到定时器 J 触发，转为 Terminated 状态</li></ul></li><li>服务器事务必须在进入 Terminated 状态的瞬间被销毁。</li></ul></li></ul><h3 id="事务的的匹配"><a href="#事务的的匹配" class="headerlink" title="事务的的匹配"></a>事务的的匹配</h3><p>在 VIA 中有 z9hG4bK 字符，通过魔法字符进行匹配。没有就采用 Request-URI, To tag, From tag, Call-ID, CSeq, and top Via header<br>匹配对应的 事务。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="freeswitch" scheme="http://nikohpng.github.io/categories/freeswitch/"/>
    
    
    <category term="sip" scheme="http://nikohpng.github.io/tags/sip/"/>
    
  </entry>
  
  <entry>
    <title>Sip协议中的一些概念</title>
    <link href="http://nikohpng.github.io/2023/12/24/freeswitch/Sip%E5%8D%8F%E8%AE%AE%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5/"/>
    <id>http://nikohpng.github.io/2023/12/24/freeswitch/Sip%E5%8D%8F%E8%AE%AE%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5/</id>
    <published>2023-12-24T03:13:54.000Z</published>
    <updated>2023-12-24T03:18:23.179Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文主要介绍 SIP 协议中的一些缩写字符的含义，这些缩写在阅读 Sofia-sip 的代码时常有出现</p><h2 id="Sip-缩写字符"><a href="#Sip-缩写字符" class="headerlink" title="Sip 缩写字符"></a>Sip 缩写字符</h2><ul><li><p>线性空白（Linear White Space，简称LWS）: 位于文本字符序列中的空白字符，包括空格、制表符和换行符等。<br>在计算机编程中，线性空白通常用来描述文本中字符之间的间距，包括但不限于字母、数字、标点符号等。<br>线性空白与非线性空白（Non-Linear White Space，简称NLWS）相对，非线性空白一般指符号或标点之间的间距，如句子结束的标点符号与下一句的起始字母之间的间隔</p></li><li><p>CRLF: 换行符</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="freeswitch" scheme="http://nikohpng.github.io/categories/freeswitch/"/>
    
    
    <category term="Sip" scheme="http://nikohpng.github.io/tags/Sip/"/>
    
  </entry>
  
  <entry>
    <title>Sofia中的一些概念</title>
    <link href="http://nikohpng.github.io/2023/12/23/freeswitch/Sofia%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5/"/>
    <id>http://nikohpng.github.io/2023/12/23/freeswitch/Sofia%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5/</id>
    <published>2023-12-23T13:36:32.000Z</published>
    <updated>2023-12-23T13:42:27.455Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文主要对 Sofia 中的一些概念进行分析与解释，方便进行源码阅读。</p><h2 id="Sofia-概念"><a href="#Sofia-概念" class="headerlink" title="Sofia 概念"></a>Sofia 概念</h2><h3 id="事件循环Event-loop-与根对象-root-object"><a href="#事件循环Event-loop-与根对象-root-object" class="headerlink" title="事件循环Event loop 与根对象 root object"></a>事件循环Event loop 与根对象 root object</h3><ul><li>NUA以事件反应器模式(也称为分发及通知模式)驱动事件系统(请参考[Using Design Patterns to Develop Reusable Object-oriented Communication Software, D.C. Schmidt, CACM October ‘95, 38(10): 65-74]一书)。<br>Sofia以任务作为编程模型的基本执行单元。根据编程模型，程序可以请求事件循环在特定事件触发时调用回调函数。具体事件包括I/O激活，定时器或其它任务传递的异步消息。</li><li>root 对象是应用软件中描述一个任务的句柄。<ul><li>透视事件的另一种方式是：root对象描述任务的主事件循环。通过root对象，任务代码可以访问它的上下文信息(magic)和线程同步，比如说等待对象、定时器，消息。</li></ul></li><li>使用NUA服务的应用必须创建一个root对象，并设置处理NUA事件的回调函数。<ul><li>调用 <code>su_root_create()</code>创建root对象，调用<code>nua_create()</code>函数注册回调函数。root 对象的数据类型是 su_root_t。</li></ul></li></ul><h3 id="Magic"><a href="#Magic" class="headerlink" title="Magic"></a>Magic</h3><ul><li>magic 是一种描述上下文指针的术语，应用程序可以把它绑定到Sofia栈的各种对象上（比如说root对象和操作句柄）。当主事件循环调用注册的回调函数时，上下文指针会回传给应用层代码。<br>Sofia栈保留回调函数调用之间的上下文信息。应用层可以利用上下文信息存储处理事件所需要的任何信息</li></ul><h3 id="内存处理"><a href="#内存处理" class="headerlink" title="内存处理"></a>内存处理</h3><ul><li>给定的任务需要分配许多小块内存时，使用home-based内存管理机制会很便利。内存通过home对象分配，它维护所有内存块的引用信息。当home对象释放时，所有相关内存一并释放。这个机制简化了应用逻辑，因为应用层代码不需要跟踪内存块的分配记录，也不需要独立释放每一个内存块。<br>使用NUA服务的应用程序可以使用SU库提供的内存管理服务，但这不是强制要求的。</li></ul><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><ul><li><a href="https://blog.csdn.net/yetyongjin/article/details/105839864">Sofia “nua”模块–高层UA库</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="freeswitch" scheme="http://nikohpng.github.io/categories/freeswitch/"/>
    
    
    <category term="Sofia" scheme="http://nikohpng.github.io/tags/Sofia/"/>
    
  </entry>
  
  <entry>
    <title>Sofia发送subscriber的源码解析</title>
    <link href="http://nikohpng.github.io/2023/12/23/freeswitch/Sofia%E5%8F%91%E9%80%81subscriber%E7%9A%84%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <id>http://nikohpng.github.io/2023/12/23/freeswitch/Sofia%E5%8F%91%E9%80%81subscriber%E7%9A%84%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</id>
    <published>2023-12-23T12:48:25.000Z</published>
    <updated>2023-12-23T13:35:20.713Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文将对 sofia 发送 subscriber 这个信令进行源码分析其中会对一些涉及到的其它源码进行解析，用以后续学习</p><h2 id="Sofia-的-handle"><a href="#Sofia-的-handle" class="headerlink" title="Sofia 的 handle"></a>Sofia 的 handle</h2><p>这里对 handle 进行一定的解释。这个 handle 用于管理向谁发送什么样的数据，这个谁一般指定 uac 。 一个 handle 会生成一个新的 call-id，产生一个新的 session。</p><ul><li><code>nua_handle_destroy()</code>: 用于销毁这个 handle。<ul><li>小知识：FreeSWITCH 一般在创建后 <code>nua_handle_bind(fnh, &amp;mod_sofia_globals.destroy_private)</code>，后续不用后会自动销毁, 这个销毁主要依赖于 our_sofia_event_callback<br>中的以下代码：<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((sofia_private &amp;&amp; sofia_private == &amp;mod_sofia_globals.destroy_private)) &#123;</span><br><span class="line">        nua_handle_bind(nh, <span class="literal">NULL</span>);</span><br><span class="line">        nua_handle_destroy(nh);</span><br><span class="line">        nh = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><code>nua_handle_bind</code>: 绑定给回调函数一个上下文。在发生 sip 的状态机变化的时候，nua_create 注册的回调函数会回调，其中的会带有这个绑定的值。解绑传值为 NULL</li><li><code>nua_handle_ref</code>: 增加了 handle 的 sub_ref, 未知</li><li><code>nua_handle_unref</code>: 减少了 handle 的 sub_ref，未知<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nua.c:304 </span><br></pre></td></tr></table></figure><h2 id="Sofia-的-subscribe-流程"><a href="#Sofia-的-subscribe-流程" class="headerlink" title="Sofia 的 subscribe 流程"></a>Sofia 的 subscribe 流程</h2></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nua.c:701 nua_subscribe NUA_SIGNAL(nh, nua_r_subscribe, tag, value)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="freeswitch" scheme="http://nikohpng.github.io/categories/freeswitch/"/>
    
    
    <category term="Sofia" scheme="http://nikohpng.github.io/tags/Sofia/"/>
    
  </entry>
  
  <entry>
    <title>cmake的使用记录</title>
    <link href="http://nikohpng.github.io/2023/07/11/C_Learn/cmake%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"/>
    <id>http://nikohpng.github.io/2023/07/11/C_Learn/cmake%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/</id>
    <published>2023-07-11T12:55:30.000Z</published>
    <updated>2023-07-11T13:12:18.508Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>cmake 在 win 中的编译需要使用的一些配置，主要是记录曾经使用情况</p><h2 id="Release-生成PDB"><a href="#Release-生成PDB" class="headerlink" title="Release 生成PDB"></a>Release 生成PDB</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set(CMAKE_CXX_FLAGS_RELEASE &quot;$&#123;CMAKE_CXX_FLAGS_RELEASE&#125; &#x2F;Zi&quot;)</span><br><span class="line">set(CMAKE_EXE_LINKER_FLAGS_RELEASE &quot;$&#123;CMAKE_EXE_LINKER_FLAGS_RELEASE&#125; &#x2F;DEBUG &#x2F;OPT:REF &#x2F;OPT:ICF&quot;)</span><br><span class="line">set(CMAKE_SHARED_LINKER_FLAGS_RELEASE &quot;$&#123;CMAKE_SHARED_LINKER_FLAGS_RELEASE&#125; &#x2F;DEBUG &#x2F;OPT:REF &#x2F;OPT:ICF&quot;)</span><br></pre></td></tr></table></figure><p>cmake原生中的配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set(CMAKE_CXX_FLAGS_RELEASE &quot;$&#123;CMAKE_CXX_FLAGS_RELWITHDEBINFO&#125;&quot;)</span><br><span class="line">set(CMAKE_EXE_LINKER_FLAGS_RELEASE &quot;$&#123;CMAKE_EXE_LINKER_FLAGS_RELWITHDEBINFO&#125;&quot;)</span><br><span class="line">set(CMAKE_SHARED_LINKER_FLAGS_RELEASE &quot;$&#123;CMAKE_SHARED_LINKER_FLAGS_RELWITHDEBINFO&#125;&quot;)</span><br></pre></td></tr></table></figure><ul><li><p><code>CMAKE_CXX_FLAGS_RELEASE</code>: <code>/MD /O2 /Ob2 /DNDBUG </code></p></li><li><p><code>CMAKE_CXX_FLAGS_RELWITHDEBINFO</code>: <code>/MD /O2 /Ob1 /DNDBUG /Zi </code></p></li><li><p><code>CMAKE_SHARED_LINKER_FLAGS_RELEASE</code>: <code>/INCREMENTAL:NO</code></p></li><li><p><code>CMAKE_SHARED_LINKER_FLAGS_RELWITHDEBINFO</code>: <code>/debug /INCREMENTAL</code></p></li><li><p><code>/Zi</code>: 调试信息不包含在对象文件或可执行文件中，这使得这些文件最小</p></li><li><p><code>/MD</code>: 动态运行时依赖库， /MT 是静态运行时库</p></li><li><p><code>/O2</code>: O2 会尝试更多的寄存器级的优化以及指令级的优化，它会在编译期间占用更多的内存的编译时间</p></li><li><p><code>/O1</code>: O1 优化会消耗少得多的编译时间。主要对代码的分支，常量以及表达式等进行优化</p></li><li><p><code>/O3</code>: 在 O2 基础上进行更多的优化，例如使用伪寄存器网络，普通函数的内联以及针对循环的更多优化</p></li><li><p><code>/O0</code>: 不做任何优化，默认编译选项</p></li><li><p><code>/OPT:REF</code>: 清除从未引用的函数和数据</p></li><li><p><code>/OPT:ICF</code>: 从链接器中删除冗余的 COMAT</p></li><li><p><code>/INCREMENTAL</code>: debug 的情况下默认是这个选项</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="cmake" scheme="http://nikohpng.github.io/categories/cmake/"/>
    
    
    <category term="cmake" scheme="http://nikohpng.github.io/tags/cmake/"/>
    
  </entry>
  
  <entry>
    <title>powershell安装配置内容</title>
    <link href="http://nikohpng.github.io/2023/06/22/system/powershell%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%86%85%E5%AE%B9/"/>
    <id>http://nikohpng.github.io/2023/06/22/system/powershell%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%86%85%E5%AE%B9/</id>
    <published>2023-06-22T13:03:32.000Z</published>
    <updated>2023-06-22T14:44:52.974Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="PowerShell-配置脚本"><a href="#PowerShell-配置脚本" class="headerlink" title="PowerShell 配置脚本"></a>PowerShell 配置脚本</h2><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> DirColors</span><br><span class="line"><span class="built_in">Set-Alias</span> bb <span class="string">&quot;busybox&quot;</span> </span><br><span class="line"><span class="built_in">Set-Alias</span> vim <span class="string">&quot;nvim&quot;</span></span><br><span class="line"><span class="built_in">Set-Alias</span> vi <span class="string">&quot;nvim&quot;</span></span><br><span class="line"><span class="built_in">Set-Alias</span> open <span class="string">&quot;explorer.exe&quot;</span></span><br><span class="line"><span class="built_in">Set-Alias</span> which <span class="string">&quot;gcm&quot;</span></span><br><span class="line"><span class="built_in">Set-Alias</span> vscode <span class="string">&quot;code&quot;</span></span><br><span class="line"><span class="built_in">Set-Alias</span> ll <span class="string">&quot;ls&quot;</span></span><br><span class="line"><span class="built_in">Set-Alias</span> android <span class="string">&quot;D:\Install\IDE\Android Studio\bin\studio64.exe&quot;</span></span><br><span class="line"><span class="built_in">Set-Alias</span> yd <span class="string">&quot;C:\Users\heping\Documents\WindowsPowerShell\yd.ps1&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">locate</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$args</span>[<span class="number">0</span>].StartsWith(<span class="string">&quot;-&quot;</span>)) &#123;</span><br><span class="line">        D:\Install\Manager\Everything\Everything.exe <span class="variable">$args</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        D:\Install\Manager\Everything\Everything.exe <span class="literal">-s</span> <span class="variable">$args</span>[<span class="number">0</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="安装的软件"><a href="#安装的软件" class="headerlink" title="安装的软件"></a>安装的软件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scoop install busybox</span><br><span class="line">scoop install sudo</span><br></pre></td></tr></table></figure><h2 id="配置内容"><a href="#配置内容" class="headerlink" title="配置内容"></a>配置内容</h2><ul><li>busybox 软链接配置<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="variable">%%i</span> <span class="keyword">in</span> (ar, arch, ash, awk, base64, basename, bash, bunzip2, bzcat, bzip2, cal, cat, chmod, cksum, ^</span><br><span class="line">          clear, cmp, comm, cp, cpio, cut, <span class="built_in">date</span>, dc, dd, df, diff, dirname, dos2unix, dpkg, dpkg-deb, du, <span class="built_in">echo</span>, ed,^</span><br><span class="line">          egrep, env, expand, expr, factor, false, fgrep, <span class="built_in">find</span>, fold, fsync, ftpget, ftpput, getopt, grep, groups,^</span><br><span class="line">          gunzip, gzip, hd, head, hexdump, iconv, id, ipcalc, kill, killall, less, link, ln, logname, ls, lzcat, lzma,^</span><br><span class="line">          lzop, lzopcat, man, md5sum, <span class="built_in">mkdir</span>, mktemp, mv, nc, nl, od, paste, patch, pgrep, pidof, pipe_progress, pkill,^</span><br><span class="line">          printenv, printf, ps, pwd, readlink, realpath, reset, rev, rm, <span class="built_in">rmdir</span>, rpm, rpm2cpio, sed, seq, sh, sha1sum,^</span><br><span class="line">          sha256sum, sha3sum, sha512sum, shred, shuf, sleep, <span class="built_in">sort</span>, split, ssl_client, stat, strings, su, sum, tac, tail,^</span><br><span class="line">          tar, tee, test, timeout, touch, tr, true, truncate, ts, ttysize, uname, uncompress, unexpand, uniq, unix2dos,^</span><br><span class="line">          unlink, unlzma, unlzop, unxz, unzip, usleep, uudecode, uuencode, vi, watch, wc, wget, which, whoami, whois,^</span><br><span class="line">          xargs, xxd, xz, xzcat, yes, zcat)^</span><br><span class="line">  <span class="keyword">do</span> mklink C:\Windows\System32\<span class="variable">%%i</span>.exe C:\Windows\System32\busybox.exe</span><br><span class="line"><span class="keyword">for</span> <span class="variable">%%i</span> <span class="keyword">in</span> (ar, arch, ash, awk, base64, basename, bash, bunzip2, bzcat, bzip2, cal, cat, chmod, cksum, ^</span><br><span class="line">             clear, cmp, comm, cp, cpio, cut, <span class="built_in">date</span>, dc, dd, df, diff, dirname, dos2unix, dpkg, dpkg-deb, du, <span class="built_in">echo</span>, ed,^</span><br><span class="line">             egrep, env, expand, expr, factor, false, fgrep, <span class="built_in">find</span>, fold, fsync, ftpget, ftpput, getopt, grep, groups,^</span><br><span class="line">             gunzip, gzip, hd, head, hexdump, iconv, id, ipcalc, kill, killall, less, link, ln, logname, ls, lzcat, lzma,^</span><br><span class="line">             lzop, lzopcat, man, md5sum, <span class="built_in">mkdir</span>, mktemp, mv, nc, nl, od, paste, patch, pgrep, pidof, pipe_progress, pkill,^</span><br><span class="line">             printenv, printf, ps, pwd, readlink, realpath, reset, rev, rm, <span class="built_in">rmdir</span>, rpm, rpm2cpio, sed, seq, sh, sha1sum,^</span><br><span class="line">             sha256sum, sha3sum, sha512sum, shred, shuf, sleep, <span class="built_in">sort</span>, split, ssl_client, stat, strings, su, sum, tac, tail,^</span><br><span class="line">             tar, tee, test, timeout, touch, tr, true, truncate, ts, ttysize, uname, uncompress, unexpand, uniq, unix2dos,^</span><br><span class="line">             unlink, unlzma, unlzop, unxz, unzip, usleep, uudecode, uuencode, vi, watch, wc, wget, which, whoami, whois,^</span><br><span class="line">             xargs, xxd, xz, xzcat, yes, zcat)^</span><br><span class="line">rm C:\Windows\System32\b<span class="variable">%%i</span>.exe</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="Shell" scheme="http://nikohpng.github.io/categories/Shell/"/>
    
    
    <category term="PowerShell" scheme="http://nikohpng.github.io/tags/PowerShell/"/>
    
  </entry>
  
  <entry>
    <title>FreeSWITCH问题分析</title>
    <link href="http://nikohpng.github.io/2023/04/27/freeswitch/FreeSWITCH%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90/"/>
    <id>http://nikohpng.github.io/2023/04/27/freeswitch/FreeSWITCH%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90/</id>
    <published>2023-04-27T12:47:49.000Z</published>
    <updated>2023-12-23T12:47:17.067Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文主要讲解在实际运维过程中容易出现的问题现象以及导致其出现问题的根本原因，可能附带有解决方法</p><h2 id="30s挂断"><a href="#30s挂断" class="headerlink" title="30s挂断"></a>30s挂断</h2><p>呼叫通没问题，但是会出现 30s 挂断。一般原因有以下几个方面：</p><ul><li>外网端口与内网端口没有一对一映射：端口错误，导致客户端与 FS 的沟通出现网络无法连接问题，可能是 ACK 问题。<ul><li>解决方案：将接口一对一映射</li></ul></li></ul><h2 id="FS与opensip使用tls对接时，2分钟-tcp-断连"><a href="#FS与opensip使用tls对接时，2分钟-tcp-断连" class="headerlink" title="FS与opensip使用tls对接时，2分钟 tcp 断连"></a>FS与opensip使用tls对接时，2分钟 tcp 断连</h2><p>opensips 本身有个参数 <code>tcp_connection_lifetime</code> 用于控制 tcp 的存活时长，此存活时长只能通过与服务端发送数据来延长时间，无法通过 tcp 本身的 <code>keepalive</code> 来进行保活。</p><p>最后，必须通过 fs 端发送 option 来延长 tcp 的存活时间。<br>想要实现在通话中发送 option，那么必须使用 gateway ，并在 gateway 中配置 <code>ping</code> 来发送 option。</p><p>其中，option 存在问题还没开始通话就有 option 进行发送，其中的端口与通话的端口有什么关系呢？根据抓包发现：当前没通话，有新的呼叫创建情况下，有option，那就直接用option的端口。因而网关的option没通话时的option与新来通话后的option是同一个端口。</p><blockquote><p>注意：目前仅仅测试通过了 fs 作为 fresher 进行刷新保活，服务器作为 refresher 时，其 update 无法发送到 fs</p></blockquote><h2 id="修改FS的contact"><a href="#修改FS的contact" class="headerlink" title="修改FS的contact"></a>修改FS的contact</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;param name&#x3D;&quot;apply-nat-acl&quot; value&#x3D;&quot;nat.auto&quot;&#x2F;&gt;</span><br><span class="line">&lt;action application&#x3D;&quot;export&quot; data&#x3D;&quot;sip_contact_user&#x3D;$&#123;sip_from_user&#125;&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure><h2 id="FS-修改由客户端刷新-session"><a href="#FS-修改由客户端刷新-session" class="headerlink" title="FS 修改由客户端刷新 session"></a>FS 修改由客户端刷新 session</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;enable-timer&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;session-timeout&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1800&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h2 id="FS-修改语音舒适噪音问题"><a href="#FS-修改语音舒适噪音问题" class="headerlink" title="FS 修改语音舒适噪音问题"></a>FS 修改语音舒适噪音问题</h2><p>防止hold后一直播放铃音，导致无法unhold。sdp 中也有 cng 相关配置，具体请看 sdp</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;suppress-cng&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h2 id="FS-回复指定的SIP错误信息"><a href="#FS-回复指定的SIP错误信息" class="headerlink" title="FS 回复指定的SIP错误信息"></a>FS 回复指定的SIP错误信息</h2><pre><code class="lua">local response_code = &quot;500&quot; -- 响应码为500，表示Internal Server Errorlocal reason_phrase = &quot;Internal Server Error&quot; -- 响应原因短语session:execute(&quot;respond&quot;, response_code .. &quot; &quot; .. reason_phrase)···</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="FreeSWTICH" scheme="http://nikohpng.github.io/categories/FreeSWTICH/"/>
    
    
    <category term="Question" scheme="http://nikohpng.github.io/tags/Question/"/>
    
  </entry>
  
  <entry>
    <title>WebRTC问题分析内容</title>
    <link href="http://nikohpng.github.io/2023/04/25/webrtc/WebRTC%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90%E5%86%85%E5%AE%B9/"/>
    <id>http://nikohpng.github.io/2023/04/25/webrtc/WebRTC%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90%E5%86%85%E5%AE%B9/</id>
    <published>2023-04-25T12:41:53.000Z</published>
    <updated>2023-04-25T12:50:37.819Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>WebRTC 的问题分析分析主要记录一些使用 WebRTC 过程中出现的问题，并且当前没有成体系的内容用于总结，简单的零散分析</p><h2 id="WebRTC-的-oncandidate-时候失败，导致-setLocalDescription-耗时增加"><a href="#WebRTC-的-oncandidate-时候失败，导致-setLocalDescription-耗时增加" class="headerlink" title="WebRTC 的 oncandidate 时候失败，导致 setLocalDescription 耗时增加"></a>WebRTC 的 oncandidate 时候失败，导致 setLocalDescription 耗时增加</h2><ul><li>问题：如标题所诉，由于在收集本地网络环境的，一些网卡（虚拟网卡等）的 ip，不具有连接网络的能力，导致在收集 IP 的时候会出现失败。</li><li>解决方案：监听来自 oncandidate 的事件，检测到有 relay 或 srly 的就可以直接调用 complete  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">session.on(<span class="string">&quot;icecandidate&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (event.candidate.type === <span class="string">&quot;srflx&quot;</span> &amp;&amp;</span><br><span class="line">        event.candidate.relatedAddress !== <span class="literal">null</span> &amp;&amp;</span><br><span class="line">        event.candidate.relatedPort !== <span class="literal">null</span>) &#123;</span><br><span class="line">        event.ready();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li>查看错误：通过 <code>chrome://webrtc-internals</code> 即可查看 ice 收集失败的时候，对应的 ip 是多少</li></ul><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><ul><li><a href="https://stackoverflow.com/questions/61253322/a-40-sec-delay-of-sip-call-initiation-using-jssip-webrtc">A 40 sec delay of SIP call initiation using JSSIP / WebRTC</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="WebRTC" scheme="http://nikohpng.github.io/categories/WebRTC/"/>
    
    
    <category term="Question" scheme="http://nikohpng.github.io/tags/Question/"/>
    
  </entry>
  
  <entry>
    <title>WebRTC源码中文件的作用</title>
    <link href="http://nikohpng.github.io/2023/03/30/webrtc/WebRTC%E6%BA%90%E7%A0%81%E4%B8%AD%E6%96%87%E4%BB%B6%E7%9A%84%E4%BD%9C%E7%94%A8/"/>
    <id>http://nikohpng.github.io/2023/03/30/webrtc/WebRTC%E6%BA%90%E7%A0%81%E4%B8%AD%E6%96%87%E4%BB%B6%E7%9A%84%E4%BD%9C%E7%94%A8/</id>
    <published>2023-03-30T13:03:54.000Z</published>
    <updated>2023-03-30T13:09:29.983Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文主要讲解在 WebRTC 中一些文件的作用，并且其用途在编译过程中的一些用途。当然这些文件主要是一些配置文件，不包括源码文件</p><h2 id="src-中源码"><a href="#src-中源码" class="headerlink" title="src 中源码"></a>src 中源码</h2><ul><li><code>BUILD.gn</code>：本文件主要包含了各种需要编译的各种源码，其中配置了编译 SDK 时，需要编译的源码。</li><li><code>DEPS</code>：主要包含的是一些依赖文件，例如：openh264、ffmpeg等这类依赖文件</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="WebRTC" scheme="http://nikohpng.github.io/categories/WebRTC/"/>
    
    
    <category term="Source" scheme="http://nikohpng.github.io/tags/Source/"/>
    
  </entry>
  
  <entry>
    <title>WebRTC在Mac中的编译</title>
    <link href="http://nikohpng.github.io/2023/03/30/webrtc/WebRTC%E5%9C%A8Mac%E4%B8%AD%E7%9A%84%E7%BC%96%E8%AF%91/"/>
    <id>http://nikohpng.github.io/2023/03/30/webrtc/WebRTC%E5%9C%A8Mac%E4%B8%AD%E7%9A%84%E7%BC%96%E8%AF%91/</id>
    <published>2023-03-30T12:26:21.000Z</published>
    <updated>2023-03-30T12:27:21.197Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="webrtc-在-mac-编译-Mac-与-IOS"><a href="#webrtc-在-mac-编译-Mac-与-IOS" class="headerlink" title="webrtc 在 mac 编译 Mac 与 IOS"></a>webrtc 在 mac 编译 Mac 与 IOS</h1><p>本文将会讲解在 mac 中从拉取代码到打包成 xcframework 的所有步骤，包中包括了ios 与 mac 的所有包。</p><h2 id="设置代理"><a href="#设置代理" class="headerlink" title="设置代理"></a>设置代理</h2><p>编译 WebRTC 全程需要代理软件，所以建议设置好代理软件。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export http_porxy&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1:21087&quot;</span><br><span class="line">export https_porxy&#x3D;&quot;https:&#x2F;&#x2F;127.0.0.1:21087&quot;</span><br></pre></td></tr></table></figure><blockquote><p>注意：即使在 MAC 中开启全局代理，仍然需要设置代理。本人编译时，没配置这个有时候出现无法下载外网资源，即使开了全局代理也没用。</p></blockquote><h2 id="安装-depot-tools"><a href="#安装-depot-tools" class="headerlink" title="安装 depot_tools"></a>安装 depot_tools</h2><p>depot_tools 是一套 Google 用来编译 WebRTC 的构建工具，获取 depot_tools 前，请先开启 VPN。</p><p>下载 <a href="https://storage.googleapis.com/chrome-infra/depot_tools.zip">depot_tools</a> 解压到某个目录，然后配置系统环境</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PWD/depot_tools:$PATH</span><br></pre></td></tr></table></figure><h2 id="获取源代码"><a href="#获取源代码" class="headerlink" title="获取源代码"></a>获取源代码</h2><p>获取源代码<strong>不能使用官网的源代码</strong>，必须到 <a href="https://github.com/webrtc-sdk/webrtc">webrtc-sdk</a> 中获取专门为 <a href="https://github.com/flutter-webrtc/flutter-webrtc">flutter-webrtc</a>修改过的源码。<br>获取源码步骤如下所示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mkdir webrtc</span><br><span class="line">cd webrtc</span><br><span class="line">touch .gclient</span><br><span class="line">echo &quot;solutions = [</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;name&quot;: &quot;src&quot;,</span><br><span class="line">    &quot;url&quot;: &quot;https://github.com/webrtc-sdk/webrtc.git&quot;,</span><br><span class="line">    &quot;deps_file&quot;: &quot;DEPS&quot;,</span><br><span class="line">    &quot;managed&quot;: False,</span><br><span class="line">    &quot;custom_deps&quot;: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br><span class="line">target_os = [&#x27;ios&#x27;]&quot; &gt; .gclient</span><br><span class="line">sudo gclient sync</span><br></pre></td></tr></table></figure><h2 id="生成示例代码"><a href="#生成示例代码" class="headerlink" title="生成示例代码"></a>生成示例代码</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gn gen out/ios --args=&#x27;target_os=&quot;ios&quot; target_cpu=&quot;arm64&quot; is_component_build=false&#x27; --ide=xcode </span><br></pre></td></tr></table></figure><h2 id="替换本地编译-Frameworks"><a href="#替换本地编译-Frameworks" class="headerlink" title="替换本地编译 Frameworks"></a>替换本地编译 Frameworks</h2><p>在  flutter-webrtc 的 IOS 目录下面创建  Frameworks 目录，然后修改 podfile 如下所示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># s.dependency &#39;WebRTC-SDK&#39;, &#39;104.5112.02&#39;</span><br><span class="line">  s.ios.vendored_frameworks &#x3D; &#39;Frameworks&#x2F;WebRTC.xcframework&#39;</span><br><span class="line">  s.vendored_frameworks &#x3D; &#39;WebRTC.xcframework&#39;</span><br></pre></td></tr></table></figure><h2 id="异常问题"><a href="#异常问题" class="headerlink" title="异常问题"></a>异常问题</h2><p>在拉取源代码的时候、获取依赖或者编译时可能出现各种奇奇怪怪的问题，下面会对一些奇怪问题进行解释与给出解决方法。</p><ul><li><p>:fatal: early EOF fatal: index-pack failed</p><ul><li>原因：此问题说拉取代码时，容量不够</li><li>解决方法：未知原因导致其存储在缓存空间，只要使用 sudo 权限去执行 gclient sync 即可解决问题</li></ul></li><li><p>下载某个资源时出现 ssl 验证错误。好像是更新 gclient 的时候。</p><ul><li>原因：由于我们挂了代理，不知什么原因导致了 ssl 验证失败</li><li>解决方法：需要 python 安装一个如下所示的内容，建议直接全局搜索 <code>Certificates.command</code> 这个文件所在位置  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">where python3</span><br><span class="line">sudo python3 install Certificates.command</span><br></pre></td></tr></table></figure></li></ul></li><li><p>Failed to fetch file gs://chromiumxxxx</p><ul><li>原因：不知道啥原因，反正没法下载，只能自己手动下载了</li><li>解决方法：将其中的 <code>gs://</code> 替换为 <code>https://storage.googleapis.com/</code> 直接下载，然后将其改名为具体文件，放到指定位置下面就行。</li><li>补充：MAC 这边一共有 <code>clang</code>、<code>clang-format</code>、<code>test-fonts.tar.gz</code> 这几个文件没法下载，手动下载即可。其中 <code>test-fonts.tar.gz</code> 下载下来会是个<code>**.tar</code> 文件，只需要改成 <code>test-fonts.tar</code> 放入指定文件夹即可。</li></ul></li><li><p>error at <code>xtest_module_target=&quot;//test:google_test_runner_objc&quot;</code></p><ul><li>原因：目前不知道原因</li><li>解决方法：直接去对应位置注释掉这行依赖，仍然可以使用</li></ul></li><li><p>cpid更新失败代理新的配置方案</p><ul><li>原因：配置了 https 代理的情况下，会对 ssl 进行验证，而由于我们开了代理，这个验证基本会失败</li><li>解决方法：将 https 代理设置成 http 代理就不会出现问题了。<code>export https_porxy=&quot;http://127.0.0.1:21087&quot;</code></li></ul></li><li><p>可能碰到编译错误——fatal error: ‘libavutil/avconfig.h’ file not found:</p><ul><li>原因：目前不知道原因</li><li>解决方法：在 src/third_party/ffmpeg/libavutil/avconfig.h 中创建此文件，并填入如下内容：  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Generated by ffconf */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> AVUTIL_AVCONFIG_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AVUTIL_AVCONFIG_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AV_HAVE_BIGENDIAN 0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AV_HAVE_FAST_UNALIGNED 0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/* AVUTIL_AVCONFIG_H */</span></span></span><br></pre></td></tr></table></figure></li></ul></li></ul><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p><a href="https://blog.csdn.net/anyRTC/article/details/121225296">IOS技术分享| WebRTC iOS源码下载&amp;编译</a><br><a href="https://juejin.cn/post/7119027229824122888">记录一次WebRTC iOS的源码编译过程</a><br><a href="https://www.cnblogs.com/elesos/p/9914766.html">在windows上编译chrome浏览器Building Chromium for Windows</a><br><a href="https://blog.csdn.net/xzy565143480/article/details/103194085">MacOS Python3.7 出现SSL: CERTIFICATE_VERIFY_FAILED报错解决方案</a><br><a href="https://hackmd.io/@eDUv2-UvT0mEwZSnPiH3Rg/ByYCr2_sL">Build WebRTC library for iOS</a><br><a href="http://myblog.emhct.net.cn/index.php/archives/2016">【webrtc、gclient】cpid更新失败代理新的配置方案</a><br><a href="https://blog.csdn.net/m0_37671478/article/details/100567535">Flutter插件开发，ios添加本地第三方framework</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="WebRTC" scheme="http://nikohpng.github.io/categories/WebRTC/"/>
    
    
    <category term="WebRTC编译" scheme="http://nikohpng.github.io/tags/WebRTC%E7%BC%96%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>WebRTC在ubuntu中编译android</title>
    <link href="http://nikohpng.github.io/2023/03/30/webrtc/WebRTC%E5%9C%A8ubuntu%E4%B8%AD%E7%BC%96%E8%AF%91android/"/>
    <id>http://nikohpng.github.io/2023/03/30/webrtc/WebRTC%E5%9C%A8ubuntu%E4%B8%AD%E7%BC%96%E8%AF%91android/</id>
    <published>2023-03-30T11:59:43.000Z</published>
    <updated>2023-03-30T12:18:59.815Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文将会讲解在 ubuntu 中拉取代码 flutter 中的 <a href="https://github.com/webrtc-sdk/webrtc.git">WebRTC</a> 并打包成 android 可以使用的 aar。</p><blockquote><p>注意：编译 Android 的时候，建议在国外的服务器上编译，否则可能出现无法获取各种依赖文件的问题</p></blockquote><h2 id="系统选择"><a href="#系统选择" class="headerlink" title="系统选择"></a>系统选择</h2><p>注意：在编译 android 端的 WebRTC 的时候必须选择 ubuntu，其中最好是采用以下版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Ubuntu 14.04 LTS (trusty with EoL April 2022）</span><br><span class="line">Ubuntu 16.04 LTS (xenial with EoL April 2024）</span><br><span class="line">Ubuntu 18.04 LTS (bionic with EoL April 2028）</span><br><span class="line">Ubuntu 20.04 LTS (focal with Eol April 2030)</span><br><span class="line">Ubuntu 20.10 (groovy) </span><br><span class="line">Debian 10 (buster) or later</span><br></pre></td></tr></table></figure><p>如果不是，那么可能遇到一些环境问题，需要手动修改源码</p><h2 id="设置代理"><a href="#设置代理" class="headerlink" title="设置代理"></a>设置代理</h2><p>拉取 WebRTC 全程需要代理软件，所以请先设置好代理软件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export http_proxy=http://192.168.101.21:7890</span><br><span class="line">export https_proxy=http://192.168.101.21:7890</span><br></pre></td></tr></table></figure><h2 id="安装-depot-tools"><a href="#安装-depot-tools" class="headerlink" title="安装 depot_tools"></a>安装 depot_tools</h2><p>depot_tools 是一套 Google 用来编译 WebRTC 的构建工具，获取 depot_tools 前，请先开启 VPN。</p><p>下载 <a href="https://storage.googleapis.com/chrome-infra/depot_tools.zip">depot_tools</a> 解压到某个目录，然后配置系统环境</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;export PATH=$PWD/depot_tools:$PATH&quot; &gt; $HOME/.bashrc</span><br><span class="line">source $HOME/.bashrc</span><br></pre></td></tr></table></figure><h2 id="获取源码"><a href="#获取源码" class="headerlink" title="获取源码"></a>获取源码</h2><p>获取源代码不能使用官网的源代码，必须到 <a href="https://github.com/webrtc-sdk/webrtc">webrtc-sdk</a> 中获取专门为 <a href="https://github.com/flutter-webrtc/flutter-webrtc">flutter-webrtc</a> 修改过的源码。<br>获取源码步骤如下所示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mkdir webrtc</span><br><span class="line">cd webrtc</span><br><span class="line">touch .gclient</span><br><span class="line">echo &quot;solutions &#x3D; [</span><br><span class="line">  &#123;</span><br><span class="line">    &#39;name&#39;: &#39;src&#39;,</span><br><span class="line">    &#39;url&#39;: &#39;https:&#x2F;&#x2F;github.com&#x2F;webrtc-sdk&#x2F;webrtc.git&#39;,</span><br><span class="line">    &#39;deps_file&#39;: &#39;DEPS&#39;,</span><br><span class="line">    &#39;managed&#39;: False,</span><br><span class="line">    &#39;custom_deps&#39;: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br><span class="line">target_os &#x3D; [&#39;android&#39;]&quot; &gt; .gclient</span><br><span class="line">gclient sync --nohooks --no-history</span><br></pre></td></tr></table></figure><h2 id="源码编译"><a href="#源码编译" class="headerlink" title="源码编译"></a>源码编译</h2><ul><li><p>安装编译依赖：</p>  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gclient runhooks</span><br><span class="line">./src/build/install-build-deps.sh</span><br><span class="line">./src/build/install-build-deps-android.sh</span><br></pre></td></tr></table></figure></li><li><p>编译 aar 文件：</p>  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vpython3 ./tools_webrtc/android/build_aar.py --build-dir webrtc_android --output ./webrtc_android/libwebrtc.aar --arch armeabi-v7a arm64-v8a x86_64 x86 --extra-gn-args &#x27;is_java_debug=false rtc_include_tests=false rtc_use_h264=false is_component_build=false use_rtti=true rtc_build_examples=false treat_warnings_as_errors=false&#x27;</span><br></pre></td></tr></table></figure><h2 id="异常问题"><a href="#异常问题" class="headerlink" title="异常问题"></a>异常问题</h2></li></ul><p>拉取代码、安装依赖或者编译的时候可能出现一些奇怪的问题，此处将对遇到的问题进行分析以及提出相应的解决方案</p><ul><li>执行<code>./src/build/install-build-deps.sh</code>, 系统版本不适配(即没有按照步骤中的系统版本进行安装)<ul><li>原因：可能你使用的系统版本过高，过低那就没法了，至少要比上诉第一条中系统最低版本高</li><li>解决方案：通过 <code>lsb_release --codename --short</code> 查询系统 <strong>short name</strong>，加入到<code>./src/build/install-build-deps.sh</code>文件下的<code>supported_codenames</code> 变量中即可</li></ul></li><li>编译代码时可能出现缺少 LASTCHANGE 和 LASTCHANGE.committime 文件<ul><li>解决方案：直接前往内网 svn 获取 <a href="svn://10.10.0.1/svnrepos/%E8%81%94%E9%80%9A/WebRTC/Dependency/M92/Win">LASTCHANGE 和 LASTCHANGE.committime</a>即可</li></ul></li><li>编译时出现 <code>Mission sysroot</code> 错误<ul><li>原因：已经很明显，少 sysroot，并且提示里面要求 <strong>run: build/linux/sysroot_scripts/install-sysroot.py –arch=amd64</strong></li><li>解决方案：运行这个脚本即可，注意打开全局代理。如果还不行就手动下载，解压后放到<code>/usr/local/sysroot</code> 目录下，配置下 <code>/etc/profile</code> 指向 <code>sysroot</code> 这个文件夹<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">   mkdir -p sysroot</span><br><span class="line">tar -xvf debian_bullseye_amd64_sysroot.tar.xz -C sysroot</span><br></pre></td></tr></table></figure></li></ul></li><li>编译时缺少 <strong>llvm-build</strong> 文件夹<ul><li>原因：不知道什么原因就是无法同步下来</li><li>解决方案：在国外服务器上同步下来后，把 <code>llvm-build</code> 文件拷贝下来即可。也可以用点击 <a href="">llvm-build</a>下载</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="WebRTC" scheme="http://nikohpng.github.io/categories/WebRTC/"/>
    
    
    <category term="WebRTC编译" scheme="http://nikohpng.github.io/tags/WebRTC%E7%BC%96%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>FreeSWITCH中xml_rpc的使用技巧</title>
    <link href="http://nikohpng.github.io/2023/03/27/freeswitch/FreeSWITCH%E4%B8%ADxml-rpc%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/"/>
    <id>http://nikohpng.github.io/2023/03/27/freeswitch/FreeSWITCH%E4%B8%ADxml-rpc%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/</id>
    <published>2023-03-27T13:12:18.000Z</published>
    <updated>2023-03-27T13:19:12.802Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文主要讲解在实际开发中，可能遇到的使用 xml_rpc 命令过程中的一些内容</p><h2 id="查询-api-的命令"><a href="#查询-api-的命令" class="headerlink" title="查询 api 的命令"></a>查询 api 的命令</h2><p>查看 xml_rpc 中的命令通过如下方式即可，在浏览器中打开如下链接：<code>http://127.0.0.1:8080/webapi/help</code></p><h2 id="调试命令"><a href="#调试命令" class="headerlink" title="调试命令"></a>调试命令</h2><ul><li>通过 curl 调用 lua 程序，并传递参数，其中空格需要用 %20 替换  <figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --user yw:yw@123 http://127.0.0.1:7652/webapi/luarun?call_phone.lua%20var</span><br></pre></td></tr></table></figure></li><li></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="FreeSWTICH" scheme="http://nikohpng.github.io/categories/FreeSWTICH/"/>
    
    
    <category term="xml_rpc" scheme="http://nikohpng.github.io/tags/xml-rpc/"/>
    
  </entry>
  
  <entry>
    <title>FreeSWITCH中mod的状态变化</title>
    <link href="http://nikohpng.github.io/2023/03/23/freeswitch/FreeSWITCH%E4%B8%ADmod%E7%9A%84%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96/"/>
    <id>http://nikohpng.github.io/2023/03/23/freeswitch/FreeSWITCH%E4%B8%ADmod%E7%9A%84%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96/</id>
    <published>2023-03-23T13:05:32.000Z</published>
    <updated>2023-03-23T13:06:04.132Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文主要讲述在 endpoint 的 mod 在启动关闭与呼叫、挂断等其中的状态变化内容</p><h2 id="mod-的启动关闭"><a href="#mod-的启动关闭" class="headerlink" title="mod 的启动关闭"></a>mod 的启动关闭</h2><p>此处的状态变化最为简单，只有两个回调函数，分别如下所示：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SWITCH_MODULE_LOAD_FUNCTION(mod_test_load);</span><br><span class="line">SWITCH_MODULE_SHUTDOWN_FUNCTION(mod_test_shutdown);</span><br><span class="line">SWITCH_MODULE_DEFINITION(mod_test, mod_test_load, mod_test_shutdown, <span class="literal">NULL</span>); <span class="comment">// mod_test_runtime</span></span><br></pre></td></tr></table></figure><p>一般 runtime 都没用，暂时不明白作用。有个这个定义后，再实现相应的启动关闭函数，如下所示：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SWITCH_MODULE_LOAD_FUNCTION(mod_test_load) &#123;</span><br><span class="line">    <span class="comment">/// 你想要实现内容，宏展开后有如下参数</span></span><br><span class="line">    <span class="comment">/// switch_loadable_module_interface_t **module_interface, switch_memory_pool_t *pool</span></span><br><span class="line">&#125;</span><br><span class="line">SWITCH_MODULE_SHUTDOWN_FUNCTION(mod_janus_shutdown) &#123;</span><br><span class="line">    <span class="comment">/// 你想要实现内容，宏展开后是个 void，没有参数值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="channel-的状态变化"><a href="#channel-的状态变化" class="headerlink" title="channel 的状态变化"></a>channel 的状态变化</h2><p>channel 的状态变化较为复杂，此处先沿着外呼的流程走一遍所有流程，并会标明调用什么函数发生状态变化，以及状态变化涉及的含义。</p><p>此处先展示所有涉及的状态以及它们分别所属结构体</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch_state_handler_table_t</span> test_state_handlers = &#123;</span><br><span class="line">    <span class="comment">/*.on_init */</span> channel_on_init,</span><br><span class="line">    <span class="comment">/*.on_routing */</span> channel_on_routing,</span><br><span class="line">    <span class="comment">/*.on_execute */</span> channel_on_execute,</span><br><span class="line">    <span class="comment">/*.on_hangup */</span> channel_on_hangup,</span><br><span class="line">    <span class="comment">/*.on_exchange_media */</span> channel_on_exchange_media,</span><br><span class="line">    <span class="comment">/*.on_soft_execute */</span> channel_on_soft_execute,</span><br><span class="line">    <span class="comment">/*.on_consume_media */</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="comment">/*.on_hibernate */</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="comment">/*.on_reset */</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="comment">/*.on_park */</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="comment">/*.on_reporting */</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="comment">/*.on_destroy */</span> channel_on_destroy&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch_io_routines_t</span> test_io_routines = &#123;</span><br><span class="line">    <span class="comment">/*.outgoing_channel */</span> channel_outgoing_channel,</span><br><span class="line">    <span class="comment">/*.read_frame */</span> channel_read_frame,</span><br><span class="line">    <span class="comment">/*.write_frame */</span> channel_write_frame,</span><br><span class="line">    <span class="comment">/*.kill_channel */</span> channel_kill_channel,</span><br><span class="line">    <span class="comment">/*.send_dtmf */</span> channel_send_dtmf,</span><br><span class="line">    <span class="comment">/*.receive_message */</span> channel_receive_message,</span><br><span class="line">    <span class="comment">/*.receive_event */</span> channel_receive_event&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">test_endpoint_interface-&gt;io_routines = &amp;test_io_routines;</span><br><span class="line">test_endpoint_interface-&gt;state_handler = &amp;test_state_handlers;</span><br></pre></td></tr></table></figure><ul><li><p>外呼 –&gt; channel_outgoing_channel:</p><ul><li><p>参数如下所示：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">switch_call_cause_t</span> <span class="title">channel_outgoing_channel</span><span class="params">(<span class="keyword">switch_core_session_t</span> *session, <span class="keyword">switch_event_t</span> *var_event,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            <span class="keyword">switch_caller_profile_t</span> *outbound_profile,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            <span class="keyword">switch_core_session_t</span> **new_session, <span class="keyword">switch_memory_pool_t</span> **pool,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            <span class="keyword">switch_originate_flag_t</span> flags, <span class="keyword">switch_call_cause_t</span> *cancel_cause)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                                            &#125;</span><br></pre></td></tr></table></figure></li><li><p>作用：创建媒体流、创建channel、初始化参数等</p></li><li><p>状态变化函数：<code>switch_channel_set_state(channel, CS_INIT);</code></p></li><li><p>未知作用函数：<code>switch_set_flag_locked(tech_pvt, TFLAG_OUTBOUND);</code></p></li></ul></li><li><p>channel_outgoing_channel –&gt; channel_on_init:</p><ul><li><p>参数如下所示：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">switch_status_t</span> <span class="title">channel_on_init</span><span class="params">(<span class="keyword">switch_core_session_t</span> *session)</span></span></span><br></pre></td></tr></table></figure></li><li><p>作用：一般用户初始化该通呼叫所需要的一些初始化参数</p></li><li><p>返回值：状态值为 <code>SWITCH_STATUS_SUCCESS</code> 将自动进入下个状态，否则将跳过该此呼叫</p></li><li><p>状态变化函数：无</p></li><li><p>未知作用函数：<code>switch_set_flag_locked(tech_pvt, TFLAG_IO);</code></p></li></ul></li><li><p>channel_on_init –&gt; channel_on_routing:</p><ul><li><p>参数如下所示：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">switch_status_t</span> <span class="title">channel_on_routing</span><span class="params">(<span class="keyword">switch_core_session_t</span> *session)</span></span></span><br></pre></td></tr></table></figure></li><li><p>作用：一般在此处进行路由相关处理，准备编解码器、创建媒体流端口、生成sdp并与被叫方建立连接等工作</p></li><li><p>返回值：状态值为 <code>SWITCH_STATUS_SUCCESS</code> 将自动进入下个状态，否则将跳过该此呼叫</p></li><li><p>状态变化函数：<code>switch_channel_pre_answer(channel)</code> 和 <code>switch_channel_answer(channel)</code></p></li><li><p>未知作用函数：<code>switch_channel_set_flag(channel, CF_AUDIO);</code></p></li></ul></li><li><p>channel_on_routing –&gt; channel_on_execute: (可略)</p></li><li><p>channel_on_hangup:</p><ul><li><p>参数如下所示：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">switch_status_t</span> <span class="title">channel_on_hangup</span><span class="params">(<span class="keyword">switch_core_session_t</span> *session)</span></span></span><br></pre></td></tr></table></figure></li><li><p>作用：呼叫中断的时候，此处的函数就会被回调，无论是 a-leg 还是 b-leg, 一般用于销毁信令上的一些内容</p></li><li><p>返回值：状态值为 <code>SWITCH_STATUS_SUCCESS</code> 将自动进入下个状态，否则将跳过该此呼叫</p></li><li><p>状态变化函数：<code>switch_channel_hangup(channel, SWITCH_CAUSE_NORMAL_CLEARING);</code></p></li></ul></li><li><p>channel_on_hangup –&gt; channel_on_destroy:</p><ul><li><p>参数如下所示：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">switch_status_t</span> <span class="title">channel_on_destroy</span><span class="params">(<span class="keyword">switch_core_session_t</span> *session)</span></span></span><br></pre></td></tr></table></figure></li><li><p>作用：在呼叫被 hangup 完成后被回调，用于销毁初始化的媒体流、端口等</p></li><li><p>返回值：状态值为 <code>SWITCH_STATUS_SUCCESS</code> 将自动进入下个状态，否则将跳过该此呼叫</p></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="FreeSWTICH" scheme="http://nikohpng.github.io/categories/FreeSWTICH/"/>
    
    
    <category term="channels" scheme="http://nikohpng.github.io/tags/channels/"/>
    
  </entry>
  
  <entry>
    <title>FreeSWITCH在Linux下编译模块编译</title>
    <link href="http://nikohpng.github.io/2023/03/22/freeswitch/FreeSWITCH%E5%9C%A8Linux%E4%B8%8B%E7%BC%96%E8%AF%91%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91/"/>
    <id>http://nikohpng.github.io/2023/03/22/freeswitch/FreeSWITCH%E5%9C%A8Linux%E4%B8%8B%E7%BC%96%E8%AF%91%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91/</id>
    <published>2023-03-22T13:21:15.000Z</published>
    <updated>2023-12-23T12:44:50.741Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文主要讲解在 Linux 环境下编译 FreeSWITCH 模块时的配置以及所遇到的问题</p><h2 id="Linux-下编译-MOD-的配置"><a href="#Linux-下编译-MOD-的配置" class="headerlink" title="Linux 下编译 MOD 的配置"></a>Linux 下编译 MOD 的配置</h2><ul><li>在 configure.ac 中配置需要编译模块的 makefile文件，例如：src/mod/endpoints/mod_verto/Makefile  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PKG_CHECK_MODULES([HIREDIS], [hiredis &gt;= 0.10.0],[</span><br><span class="line">AM_CONDITIONAL([HAVE_HIREDIS],[true])],[</span><br><span class="line">AC_MSG_RESULT([no]); AM_CONDITIONAL([HAVE_HIREDIS],[false])])</span><br><span class="line"></span><br><span class="line">PKG_CHECK_MODULES([REDIS_PLUS], [redis++ &gt;= 1.3.10],[</span><br><span class="line">AM_CONDITIONAL([HAVE_REDIS_PLUS],[true])],[</span><br><span class="line">AC_MSG_RESULT([no]); AM_CONDITIONAL([HAVE_REDIS_PLUS],[false])])</span><br><span class="line"></span><br><span class="line">src/mod/applications/mod_redis_plus/Makefile</span><br></pre></td></tr></table></figure></li><li>在 modules.conf 中配置允许编译的模块，例如：endpoints/mod_verto</li><li>运行 <code>autoreconf -fiv</code> 重新生成 m4 文件</li><li>通过 rebootstrap.sh or bootstrap.sh 重新生成 configure 编译文件</li></ul><h2 id="关于-Linux-下模块的-Makefile-am-编写事项"><a href="#关于-Linux-下模块的-Makefile-am-编写事项" class="headerlink" title="关于 Linux 下模块的 Makefile.am 编写事项"></a>关于 Linux 下模块的 Makefile.am 编写事项</h2><h2 id="失败问题总结"><a href="#失败问题总结" class="headerlink" title="失败问题总结"></a>失败问题总结</h2><ul><li>无法生成 Makefile.in 文件<ul><li>注意模块位置不要写错了，否则无法生成</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="FreeSWTICH" scheme="http://nikohpng.github.io/categories/FreeSWTICH/"/>
    
    
    <category term="mod" scheme="http://nikohpng.github.io/tags/mod/"/>
    
  </entry>
  
  <entry>
    <title>opus编解码相关介绍</title>
    <link href="http://nikohpng.github.io/2023/03/21/codec/opus%E7%BC%96%E8%A7%A3%E7%A0%81%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D/"/>
    <id>http://nikohpng.github.io/2023/03/21/codec/opus%E7%BC%96%E8%A7%A3%E7%A0%81%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D/</id>
    <published>2023-03-21T13:04:00.000Z</published>
    <updated>2023-03-22T13:16:32.861Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文主要讲解在实际开发中遇到的关于Opus的编解码问题</p><h2 id="SDP中OPUS介绍"><a href="#SDP中OPUS介绍" class="headerlink" title="SDP中OPUS介绍"></a>SDP中OPUS介绍</h2><p>在 SDP 中，任何其它采样率都不起作用，在 rtp 传输时默认采用 48000, 可以在 <a href="https://www.rfc-editor.org/rfc/rfc7587">rfc7587 Section 4.1</a> 中查看<br>如下所示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Opus supports 5 different audio bandwidths, which can be adjusted</span><br><span class="line">during a stream.  The RTP timestamp is incremented with a 48000 Hz</span><br><span class="line">clock rate for all modes of Opus and all sampling rates.  The unit</span><br><span class="line">for the timestamp is samples per single (mono) channel.  The RTP</span><br><span class="line">timestamp corresponds to the sample time of the first encoded sample</span><br><span class="line">in the encoded frame.  For data encoded with sampling rates other</span><br><span class="line">than 48000 Hz, the sampling rate has to be adjusted to 48000 Hz.</span><br></pre></td></tr></table></figure><p>如果想要降低带宽，那么可以使用 <code>maxplaybackrate</code> 和 <code>maxaveragebitrate </code>，标准文档如下所示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">3.1.1.  Recommended Bitrate</span><br><span class="line"></span><br><span class="line">   For a frame size of 20 ms, these are the bitrate &quot;sweet spots&quot; for  Opus in various configurations:</span><br><span class="line"></span><br><span class="line">   o  8-12 kbit&#x2F;s for NB speech,</span><br><span class="line">   o  16-20 kbit&#x2F;s for WB speech,</span><br><span class="line">   o  28-40 kbit&#x2F;s for FB speech,</span><br><span class="line">   o  48-64 kbit&#x2F;s for FB mono music, and</span><br><span class="line">   o  64-128 kbit&#x2F;s for FB stereo music.</span><br></pre></td></tr></table></figure><p>例如：如果想要使用 8000HZ 的 OPUS，那么 SDP 应该如下所示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m&#x3D;audio 54312 RTP&#x2F;AVP 101</span><br><span class="line">a&#x3D;rtpmap:101 opus&#x2F;48000&#x2F;2</span><br><span class="line">a&#x3D;fmtp:101 maxplaybackrate&#x3D;8000; sprop-maxcapturerate&#x3D;8000; maxaveragebitrate&#x3D;12000</span><br></pre></td></tr></table></figure><h2 id="WebRTC-中非对称采样率工作"><a href="#WebRTC-中非对称采样率工作" class="headerlink" title="WebRTC 中非对称采样率工作"></a>WebRTC 中非对称采样率工作</h2><p>WebRTC 支持通信双方以非对称采样率工作。比如：A和B通话，A的采样率为48000，B的采样率为8000。如下所示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A--&gt;B OfferSDP</span><br><span class="line">a&#x3D;rtpmap:111 opus&#x2F;48000&#x2F;2</span><br><span class="line">a&#x3D;rtcp-fb:111 transport-cc</span><br><span class="line">a&#x3D;fmtp:111 minptime&#x3D;10;useinbandfec&#x3D;1;maxplaybackrate&#x3D;16000</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">B--&gt;A AnswerSDP</span><br><span class="line">a&#x3D;rtpmap:111 opus&#x2F;48000&#x2F;2</span><br><span class="line">a&#x3D;rtcp-fb:111 transport-cc</span><br><span class="line">a&#x3D;fmtp:111 minptime&#x3D;10;useinbandfec&#x3D;1;maxplaybackrate&#x3D;48000</span><br></pre></td></tr></table></figure><p>最终，A 采样率为48000，B 采用率为 16000</p><h2 id="WebRTC-中声道数与编码器的关系"><a href="#WebRTC-中声道数与编码器的关系" class="headerlink" title="WebRTC 中声道数与编码器的关系"></a>WebRTC 中声道数与编码器的关系</h2><p>当声道数 2 时，OPUS 编码内部将使用 celt ,代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///FIXME 暂时未查阅到</span></span><br><span class="line">config.application = config.num_channels == <span class="number">1</span> ? AudioEncoderOpus::kVoip : AudioEncoderOpus::kAudio;</span><br></pre></td></tr></table></figure><h2 id="OPUS编解码"><a href="#OPUS编解码" class="headerlink" title="OPUS编解码"></a>OPUS编解码</h2><p>OPUS代码的时候使用 <a href="https://github.com/xiph/opus">opus</a> 进行编解码，可以使用 <code>opus/doc/trivial_example.c</code> 进行测试</p><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p><a href="https://stackoverflow.com/questions/60580526/linphone-opus-codec-sampling-rate">Linphone opus codec sampling rate</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="codec" scheme="http://nikohpng.github.io/categories/codec/"/>
    
    
    <category term="opus" scheme="http://nikohpng.github.io/tags/opus/"/>
    
  </entry>
  
  <entry>
    <title>wireshark抓包分析音视频</title>
    <link href="http://nikohpng.github.io/2023/03/20/tools/wireshark%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E9%9F%B3%E8%A7%86%E9%A2%91/"/>
    <id>http://nikohpng.github.io/2023/03/20/tools/wireshark%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E9%9F%B3%E8%A7%86%E9%A2%91/</id>
    <published>2023-03-20T11:36:01.000Z</published>
    <updated>2023-03-21T13:18:45.415Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本文主要记录通过 wireshark 抓音视频的分析方法</p><h2 id="win上抓包分析"><a href="#win上抓包分析" class="headerlink" title="win上抓包分析"></a>win上抓包分析</h2><p>window上面主要以导入 lua 解析文件为主</p><ul><li><p>在 wireshark 安装目录下面，有个 init.lua， 在其中加入如下所示内容：</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dofile</span>(USER_DIR..filename)</span><br></pre></td></tr></table></figure></li><li><p>导入成功后，重启wireshark， 在工具栏中就会出现导入的 lua 文件名字。</p></li><li><p>随后到 <strong>编辑-&gt;首选项-&gt;协议</strong> 中根据需要解码的音视频，填写 payload 值</p></li><li><p>最后，当获取到 *.pcap 文件后，点击 工具-&gt;lua的名字 运行即可</p></li></ul><h2 id="linux上抓包分析opus"><a href="#linux上抓包分析opus" class="headerlink" title="linux上抓包分析opus"></a>linux上抓包分析opus</h2><p>此处步骤仅用于在 linux 上，通过命令行的形式分析 opus</p><ul><li>获取 python 脚本，<a href="https://github.com/kamanashisroy/opus_stream_tool">opus_stream_tool</a></li><li>tcpdump -i eth0 port 1234 -w in.pcap</li><li>tshark -x -r in.pcap -Y “udp.srcport == myport” | cut -d “ “ -f 1-20 &gt; tmp.txt</li><li>hex_to_opus.py -x tmp.txt –recordfile out.opus –rtpoffset 42</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="capture" scheme="http://nikohpng.github.io/categories/capture/"/>
    
    
    <category term="opus、h264" scheme="http://nikohpng.github.io/tags/opus%E3%80%81h264/"/>
    
  </entry>
  
  <entry>
    <title>通信发展与通信原理</title>
    <link href="http://nikohpng.github.io/2023/01/14/ims/signal/%E9%80%9A%E4%BF%A1%E5%8F%91%E5%B1%95%E4%B8%8E%E9%80%9A%E4%BF%A1%E5%8E%9F%E7%90%86/"/>
    <id>http://nikohpng.github.io/2023/01/14/ims/signal/%E9%80%9A%E4%BF%A1%E5%8F%91%E5%B1%95%E4%B8%8E%E9%80%9A%E4%BF%A1%E5%8E%9F%E7%90%86/</id>
    <published>2023-01-14T03:15:43.000Z</published>
    <updated>2023-01-14T03:16:57.746Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p><a href="https://www.bilibili.com/video/BV1f7411E7qt?p=45&vd_source=0d29a16004eefac32b97ba41ab3821c1">CMDA系统</a><br><a href="https://www.bilibili.com/video/BV1vr4y1L7mm/?vd_source=0d29a16004eefac32b97ba41ab3821c1">通信复习-多路复用的三种方法：频分复用，时分复用，码分复用</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="ims" scheme="http://nikohpng.github.io/categories/ims/"/>
    
    
    <category term="signal" scheme="http://nikohpng.github.io/tags/signal/"/>
    
  </entry>
  
  <entry>
    <title>sip-i与sip-t的区别i</title>
    <link href="http://nikohpng.github.io/2023/01/14/ims/signal/sip-i%E4%B8%8Esip-t%E7%9A%84%E5%8C%BA%E5%88%ABi/"/>
    <id>http://nikohpng.github.io/2023/01/14/ims/signal/sip-i%E4%B8%8Esip-t%E7%9A%84%E5%8C%BA%E5%88%ABi/</id>
    <published>2023-01-14T02:41:12.000Z</published>
    <updated>2023-01-14T02:50:12.425Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>全球语音网络正在向基于IP的通信系统迁移。然而，现有的PSTN网络将继续存在一段时间。因此，VOIP和PSTN之间的互连能力在如今的语音市场上扮演重要的角色。</p><p>就像两种语言之间的翻译（英语&lt;-&gt;荷兰语），两个系统的映射作为基本的互连功能出现。</p><p>SIP-I和SIP-T是两种类似的方法，用于ISUP网络和SIP网络之间的互通，换句话说，就是PSTN和VoIP网络。具体来说，它们有助于通过SIP网络传送ISUP参数，这样在ISUP网络上发起和终止的呼叫就可以通过SIP网络转接，而不会丢失信息。</p><p>SIP-I和SIP-T都定义了SIP和ISUP网络之间的消息、参数和错误代码的映射。它们都可以与SIP网络上符合要求的SIP网络组件完全互操作。</p><p>SIP-I和SIP-T允许ISUP参数在SIP网络中透明传输的方式是，在入口处的PSTN网关将原始ISUP消息的字面副本附加到SIP消息中；这个ISUP消息作为另一个主体出现在SIP消息中。</p><h2 id="SIP-I-与-SIP-T-的不同点"><a href="#SIP-I-与-SIP-T-的不同点" class="headerlink" title="SIP-I 与 SIP-T 的不同点"></a>SIP-I 与 SIP-T 的不同点</h2><ul><li><p>SIP-I是由ITU在2004年开发的（定义在ITU-T Q.1912.5），而SIP-T是由开发SIP的IETF（互联网工程任务组）开发的。</p></li><li><p>SIP-I定义了从SIP到BICC以及ISUP的映射，而SIP-T只解决ISUP的问题。</p></li><li><p>SIP-T是为与本地SIP终端的互操作而设计的，而SIP-I只限于在PSTN网关之间使用。</p></li><li><p>SIP-I更准确，明确地定义了ISUP和SIP之间的参数，而且它详细地定义了电信互连的补充服务，这是SIP-T所不支持的。</p></li><li><p>SIP-I被制造商和运营商广泛接受，特别是软交换机和会话边界控制器（SBC）供应商。</p></li></ul><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p><a href="https://www.rfc-editor.org/rfc/rfc3261">RFC3261 (Session Initiation Protocol), ITU-T  Q.1912.5(Definition of SIP-I) and RFC3372 (SIP-T)</a><br><a href="https://www.differencebetween.com/difference-between-sip-i-and-sip-t/">Difference Between SIP-I and SIP-T</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="ims" scheme="http://nikohpng.github.io/categories/ims/"/>
    
    
    <category term="signal" scheme="http://nikohpng.github.io/tags/signal/"/>
    
  </entry>
  
  <entry>
    <title>janus的admin/api详解</title>
    <link href="http://nikohpng.github.io/2022/05/15/janus/janus%E7%9A%84admin-api%E8%AF%A6%E8%A7%A3/"/>
    <id>http://nikohpng.github.io/2022/05/15/janus/janus%E7%9A%84admin-api%E8%AF%A6%E8%A7%A3/</id>
    <published>2022-05-15T02:29:34.000Z</published>
    <updated>2022-05-22T12:56:56.451Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>此处讲解的 API 是用于检索 janus 的服务器信息和进行一部分的操作能力。如果你对插件内部的异步通知感兴趣，请通过 janus_eventhandler 机理</p><p>你可以通过配置 janus.transport.http.jcfg 中关于 admin API 部分，配置开启与关闭。其中你可以采用密码的形式或其它形式对访问 admin API 进行限制</p><p>当你使用 websockets 的时候，必须使用 Janus -admin-protocol 作为子协议。（可以参考janus-protocol）</p><h2 id="Admin-API-Requests"><a href="#Admin-API-Requests" class="headerlink" title="Admin API Requests"></a>Admin API Requests</h2><p>以下是不同的请求方式</p><h3 id="普通请求"><a href="#普通请求" class="headerlink" title="普通请求"></a>普通请求</h3><p>其中除了 info 都采用 <a href="https://192.168.1.51:7889/admin">https://192.168.1.51:7889/admin</a> post的形式。</p><ul><li><p>info: 用于获取服务器的一些信息，不需要秘钥即可请求</p><ul><li><p>request（get）</p>  <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 后面的数字为时间戳 </span></span><br><span class="line">https://192.168.1.51:7889/admin/info?_=1652582968747</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;server_info&quot;</span>,                            <span class="comment">// janus的action</span></span><br><span class="line">   <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;NyCxLlMIe3W&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Janus WebRTC Server&quot;</span>,                    <span class="comment">// 服务器的名字，在 janus.c 中JANUS_NAME</span></span><br><span class="line">   <span class="attr">&quot;version&quot;</span>: <span class="number">118</span>,                                    <span class="comment">// 版本数字，同上</span></span><br><span class="line">   <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.11.8&quot;</span>,                        <span class="comment">// 版本字符串，同上</span></span><br><span class="line">   <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,                        <span class="comment">// 作者，在 janus.c 中 JANUS_AUTHOR</span></span><br><span class="line">   <span class="attr">&quot;commit-hash&quot;</span>: <span class="string">&quot;not-a-git-repo&quot;</span>,                    <span class="comment">// 提交hash</span></span><br><span class="line">   <span class="attr">&quot;compile-time&quot;</span>: <span class="string">&quot;Fri Mar 25 20:42:34 PDT 2022&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;log-to-stdout&quot;</span>: <span class="literal">true</span>,                            <span class="comment">// 日志输出到标准输出</span></span><br><span class="line">   <span class="attr">&quot;log-to-file&quot;</span>: <span class="literal">false</span>,                            <span class="comment">// 日志输出到文件</span></span><br><span class="line">   <span class="attr">&quot;data_channels&quot;</span>: <span class="literal">true</span>,                            <span class="comment">// 主要用于点对点的文本、文件传输（例如：janus plugin text room）</span></span><br><span class="line">   <span class="attr">&quot;accepting-new-sessions&quot;</span>: <span class="literal">true</span>,                    <span class="comment">// 是否接受新的 sessions（例如：当服务器资源耗尽时，拒绝接受新的request）</span></span><br><span class="line">   <span class="attr">&quot;session-timeout&quot;</span>: <span class="number">60</span>,                            <span class="comment">// session 的过期时间</span></span><br><span class="line">   <span class="attr">&quot;reclaim-session-timeout&quot;</span>: <span class="number">0</span>,</span><br><span class="line">   <span class="attr">&quot;candidates-timeout&quot;</span>: <span class="number">45</span>,                        <span class="comment">// 处理webrtc（ice）的候选者连接超时时间（例如：音视频通道连接超过45秒就抛弃这个通道）</span></span><br><span class="line">   <span class="attr">&quot;server-name&quot;</span>: <span class="string">&quot;MyJanusInstance&quot;</span>,                <span class="comment">// 服务器实例的名字，在 janus.c 中 JANUS_SERVER_NAME</span></span><br><span class="line">   <span class="attr">&quot;local-ip&quot;</span>: <span class="string">&quot;192.168.1.51&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;ipv6&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">   <span class="attr">&quot;ice-lite&quot;</span>: <span class="literal">false</span>,                                <span class="comment">// ice 的轻量版本，仅用于响应来自其它端的 ice 请求,且它等待其它端发送给他应该如何建立媒体流通道。（用于公网部署）</span></span><br><span class="line">   <span class="attr">&quot;ice-tcp&quot;</span>: <span class="literal">false</span>,                                <span class="comment">// ice 的连接采用 tcp 方式，有udp用 udp，没 udp 用 tcp。（注：libnice 小于  0.1.8 不支持 tcp）</span></span><br><span class="line">   <span class="attr">&quot;ice-nomination&quot;</span>: <span class="string">&quot;aggressive&quot;</span>,                    <span class="comment">// ice 的选举模式，即只要双方两端连接建立成功就立即通过优先级最高的连接发送音视频流。相应的regular模式会先check，然后根据双方网络状态等一系列因素选出最好的连接进行流传输</span></span><br><span class="line">   <span class="attr">&quot;ice-keepalive-conncheck&quot;</span>: <span class="literal">false</span>,                <span class="comment">// ice 连接保活，在发送媒体之前会处理保活请求（注：由于 libnice 的问题，目前此参数有bug，不建议开启）</span></span><br><span class="line">   <span class="attr">&quot;full-trickle&quot;</span>: <span class="literal">false</span>,                            <span class="comment">// full 是连接的双方都进行连通性检查（注意：可能降低音视频通话连接建立速度，因为c与s端都要收集候选者并进行连通性检查）                </span></span><br><span class="line">   <span class="attr">&quot;mdns-enabled&quot;</span>: <span class="literal">true</span>,                            <span class="comment">// 启用Multicast-DNS，如果false会移除localhost的候选者，如果不是内网使用，建议设置为false</span></span><br><span class="line">   <span class="attr">&quot;min-nack-queue&quot;</span>: <span class="number">200</span>,                            <span class="comment">// 每个句柄存储用于重传的数据包的最小时间窗口</span></span><br><span class="line">   <span class="attr">&quot;nack-optimizations&quot;</span>: <span class="literal">false</span>,                        <span class="comment">// 发送关键帧前清空 nack 队列（注意：不建议打开）</span></span><br><span class="line">   <span class="attr">&quot;twcc-period&quot;</span>: <span class="number">200</span>,                                <span class="comment">// webrtc 拥塞算法。定期对接收方进行反馈</span></span><br><span class="line">   <span class="attr">&quot;dtls-mtu&quot;</span>: <span class="number">1200</span>,                                <span class="comment">// dtls 的最大传输单元</span></span><br><span class="line">   <span class="attr">&quot;static-event-loops&quot;</span>: <span class="number">0</span>,                            <span class="comment">// ice 的事件循环</span></span><br><span class="line">   <span class="attr">&quot;api_secret&quot;</span>: <span class="literal">false</span>,                                <span class="comment">// 所有请求都带有密码</span></span><br><span class="line">   <span class="attr">&quot;auth_token&quot;</span>: <span class="literal">false</span>,                                <span class="comment">// 所有请求都带有 token</span></span><br><span class="line">   <span class="attr">&quot;event_handlers&quot;</span>: <span class="literal">false</span>,                            <span class="comment">// 是否启动事件处理机制，用于 janus 内部事件处理</span></span><br><span class="line">   <span class="attr">&quot;opaqueid_in_api&quot;</span>: <span class="literal">false</span>,                        <span class="comment">// janus内部事件使用的id</span></span><br><span class="line">   <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;glib2&quot;</span>: <span class="string">&quot;2.56.1&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;jansson&quot;</span>: <span class="string">&quot;2.10&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;libnice&quot;</span>: <span class="string">&quot;0.1.18&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;libsrtp&quot;</span>: <span class="string">&quot;libsrtp2 2.4.2&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;crypto&quot;</span>: <span class="string">&quot;OpenSSL 1.0.2k-fips  26 Jan 2017&quot;</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">&quot;transports&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;janus.transport.http&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS REST (HTTP/HTTPS) transport plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This transport plugin adds REST (HTTP/HTTPS) support to the Janus API via libmicrohttpd.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.2&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">2</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;janus.transport.websockets&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS WebSockets transport plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This transport plugin adds WebSockets support to the Janus API via libwebsockets.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.1&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">1</span></span><br><span class="line">      &#125;</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">&quot;events&quot;</span>: &#123;&#125;,</span><br><span class="line">   <span class="attr">&quot;loggers&quot;</span>: &#123;&#125;,</span><br><span class="line">   <span class="attr">&quot;plugins&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;janus.plugin.voicemail&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS VoiceMail plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This is a plugin implementing a very simple VoiceMail service for Janus, recording Opus streams.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.7&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">7</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;janus.plugin.audiobridge&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS AudioBridge plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This is a plugin implementing an audio conference bridge for Janus, mixing Opus streams.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.12&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">12</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;janus.plugin.echotest&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS EchoTest plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This is a trivial EchoTest plugin for Janus, just used to showcase the plugin interface.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.7&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">7</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;janus.plugin.recordplay&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS Record&amp;Play plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This is a trivial Record&amp;Play plugin for Janus, to record WebRTC sessions and replay them.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.4&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">4</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;janus.plugin.textroom&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS TextRoom plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This is a plugin implementing a text-only room for Janus, using DataChannels.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.2&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">2</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;janus.plugin.videoroom&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS VideoRoom plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This is a plugin implementing a videoconferencing SFU (Selective Forwarding Unit) for Janus, that is an audio/video router.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.9&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">9</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;janus.plugin.videocall&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS VideoCall plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This is a simple video call plugin for Janus, allowing two WebRTC peers to call each other through a server.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.6&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">6</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;janus.plugin.nosip&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS NoSIP plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This is a simple RTP bridging plugin that leaves signalling details (e.g., SIP) up to the application.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.1&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;janus.plugin.streaming&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS Streaming plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This is a streaming plugin for Janus, allowing WebRTC peers to watch/listen to pre-recorded files or media generated by an external source.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.8&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">8</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;janus.plugin.sip&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;JANUS SIP plugin&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;Meetecho s.r.l.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;This is a simple SIP plugin for Janus, allowing WebRTC peers to register at a SIP server and call SIP user agents through a Janus instance.&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version_string&quot;</span>: <span class="string">&quot;0.0.8&quot;</span>,</span><br><span class="line">         <span class="attr">&quot;version&quot;</span>: <span class="number">8</span></span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>ping：一个简单的ping/pong机制，客户端可用该接口来链路检查及预测协议的路由时间，也是不需要秘钥即可请求</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;ping&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;pong&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>loops_info: 返回每个静态事件循环当前负责多少个句柄的摘要，以防静态事件循环正在使用</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;loops_info&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;loops&quot;</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="配置相关请求"><a href="#配置相关请求" class="headerlink" title="配置相关请求"></a>配置相关请求</h3><p>请求连接上同</p><ul><li><p>get_status：返回当前服务器能被Admin API动态修改的配置变量</p><ul><li><p>request:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;get_status&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;status&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;token_auth&quot;</span>: <span class="literal">false</span>,                    <span class="comment">// 启用请求带 token</span></span><br><span class="line">        <span class="attr">&quot;session_timeout&quot;</span>: <span class="number">60</span>,                    <span class="comment">// session 过期时间</span></span><br><span class="line">        <span class="attr">&quot;reclaim_session_timeout&quot;</span>: <span class="number">0</span>,            <span class="comment">// 过期后，任能唤醒 session 的时间</span></span><br><span class="line">        <span class="attr">&quot;candidates_timeout&quot;</span>: <span class="number">45</span>,                <span class="comment">// 候选超时时间</span></span><br><span class="line">        <span class="attr">&quot;log_level&quot;</span>: <span class="number">4</span>,                            <span class="comment">// 日志输出等级</span></span><br><span class="line">        <span class="attr">&quot;log_timestamps&quot;</span>: <span class="literal">false</span>,                <span class="comment">// 在每行日志前都加时间戳</span></span><br><span class="line">        <span class="attr">&quot;log_colors&quot;</span>: <span class="literal">true</span>,                        <span class="comment">// 日志输出颜色。在 console</span></span><br><span class="line">        <span class="attr">&quot;locking_debug&quot;</span>: <span class="literal">false</span>,                    <span class="comment">// 锁的实时调试，遇到僵尸进程有用</span></span><br><span class="line">        <span class="attr">&quot;refcount_debug&quot;</span>: <span class="literal">false</span>,                <span class="comment">// 参考计数器的实时调试, 遇到内存泄漏有用</span></span><br><span class="line">        <span class="attr">&quot;libnice_debug&quot;</span>: <span class="literal">false</span>,                    <span class="comment">// ice 的调试</span></span><br><span class="line">        <span class="attr">&quot;min_nack_queue&quot;</span>: <span class="number">200</span>,                    <span class="comment">// 每个句柄存储用于重传的数据包的最小时间窗口</span></span><br><span class="line">        <span class="attr">&quot;nack-optimizations&quot;</span>: <span class="literal">false</span>,            <span class="comment">// 发送关键帧前清空 nack 队列</span></span><br><span class="line">        <span class="attr">&quot;no_media_timer&quot;</span>: <span class="number">1</span>,                    <span class="comment">// 改变没有媒体流的计时器值</span></span><br><span class="line">        <span class="attr">&quot;slowlink_threshold&quot;</span>: <span class="number">0</span>                    <span class="comment">// 每秒丢包数，超过阈值就发送 slow_link 事件到客户端，0 不发送事件</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>set_session_timeout: 改变全局的会话超时时间</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;set_session_timeout&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;timeout&quot;</span>: <span class="number">62</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;set_session_timeout&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;timeout&quot;</span>: <span class="number">62</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>set_log_level: 改变日志等级</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;set_log_level&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;level&quot;</span>: <span class="number">6</span>,                            <span class="comment">// 0-7之间的值</span></span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;level&quot;</span>: <span class="number">6</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>set_log_timestamps:使能或禁止在日志中添加时间戳</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;set_log_timestamps&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;timestamps&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;log_timestamps&quot;</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>set_log_colors: 使能或禁止日志带颜色输出</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;set_log_colors&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;colors&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;log_colors&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>set_locking_debug: 使能或禁止锁（互斥锁等）的实时调试，在遇到死锁时很有用</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;set_locking_debug&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;debug&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;locking_debug&quot;</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>set_refcount_debug:使能或禁止引用计数的实时调试，在遇到janus内部结构体内存泄漏时使用</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;set_refcount_debug&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;debug&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;refcount_debug&quot;</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>set_libnice_debug:使能或禁止libnice库的调试</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;set_libnice_debug&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;debug&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;libnice_debug&quot;</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>set_min_nack_queue:改变NACK队列的最小值</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;set_min_nack_queue&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;min_nack_queue&quot;</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;min_nack_queue&quot;</span>: <span class="number">200</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>set_no_media_timer: 改变没有媒体流的计时器值</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;set_no_media_timer&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;no_media_timer&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;no_media_timer&quot;</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>set_slowlink_threshold: 每秒丢包数，超过阈值就发送 slow_link 事件到客户端，0 不发送事件</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;set_slowlink_threshold&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;slowlink_threshold&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>reponse</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;slowlink_threshold&quot;</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="Token-相关的请求"><a href="#Token-相关的请求" class="headerlink" title="Token 相关的请求"></a>Token 相关的请求</h3><p>这部分请求只有在使能了token存储的机制之后才有效，即上面描述的 auth_token，不能使用token_auth_secret，否则就无法使用以下 api。后续的 create_session 类似都需要带上 token，否则会被拒绝</p><ul><li><p>add_token: 增加一个有效tocken</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;add_token&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;1234&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;janus.plugin.voicemail&quot;</span>,</span><br><span class="line">        <span class="string">&quot;janus.plugin.audiobridge&quot;</span>,</span><br><span class="line">        <span class="string">&quot;janus.plugin.echotest&quot;</span>,</span><br><span class="line">        <span class="string">&quot;janus.plugin.recordplay&quot;</span>,</span><br><span class="line">        <span class="string">&quot;janus.plugin.textroom&quot;</span>,</span><br><span class="line">        <span class="string">&quot;janus.plugin.videoroom&quot;</span>,</span><br><span class="line">        <span class="string">&quot;janus.plugin.videocall&quot;</span>,</span><br><span class="line">        <span class="string">&quot;janus.plugin.nosip&quot;</span>,</span><br><span class="line">        <span class="string">&quot;janus.plugin.streaming&quot;</span>,</span><br><span class="line">        <span class="string">&quot;janus.plugin.sip&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;CJjN1NTwZvui&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>reponse</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;CJjN1NTwZvui&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;data&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;plugins&quot;</span>: [</span><br><span class="line">         <span class="string">&quot;janus.plugin.voicemail&quot;</span>,</span><br><span class="line">         <span class="string">&quot;janus.plugin.audiobridge&quot;</span>,</span><br><span class="line">         <span class="string">&quot;janus.plugin.echotest&quot;</span>,</span><br><span class="line">         <span class="string">&quot;janus.plugin.recordplay&quot;</span>,</span><br><span class="line">         <span class="string">&quot;janus.plugin.textroom&quot;</span>,</span><br><span class="line">         <span class="string">&quot;janus.plugin.videoroom&quot;</span>,</span><br><span class="line">         <span class="string">&quot;janus.plugin.videocall&quot;</span>,</span><br><span class="line">         <span class="string">&quot;janus.plugin.nosip&quot;</span>,</span><br><span class="line">         <span class="string">&quot;janus.plugin.streaming&quot;</span>,</span><br><span class="line">         <span class="string">&quot;janus.plugin.sip&quot;</span></span><br><span class="line">      ]</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>allow_token: 给与一个与插件使用相关的token</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;allow_token&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;1234&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;janus.plugin.voicemail&quot;</span>,</span><br><span class="line">        <span class="string">&quot;janus.plugin.audiobridge&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;CJjN1NTwZvui&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>reponse</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;CJjN1NTwZvui&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;plugins&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;janus.plugin.voicemail&quot;</span>,</span><br><span class="line">            <span class="string">&quot;janus.plugin.audiobridge&quot;</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>disallow_token:移除一个与插件使用有关的token</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;disallow_token&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;1234&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;janus.plugin.voicemail&quot;</span>,</span><br><span class="line">        <span class="string">&quot;janus.plugin.audiobridge&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;CJjN1NTwZvui&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>reponse</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;CJjN1NTwZvui&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;plugins&quot;</span>: []</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>list_tokens: 列出现存的所有token</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;list_tokens&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;CJjN1NTwZvui&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;CJjN1NTwZvui&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;tokens&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;1234&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;allowed_plugins&quot;</span>: [</span><br><span class="line">                    <span class="string">&quot;janus.plugin.voicemail&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;janus.plugin.audiobridge&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;janus.plugin.echotest&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;janus.plugin.recordplay&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;janus.plugin.textroom&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;janus.plugin.videoroom&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;janus.plugin.videocall&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;janus.plugin.nosip&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;janus.plugin.streaming&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;janus.plugin.sip&quot;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>remove_token:删除一个token</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;remove_token&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;1234&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;eVyLDzjqfyg3&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;eVyLDzjqfyg3&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="会话相关的请求"><a href="#会话相关的请求" class="headerlink" title="会话相关的请求"></a>会话相关的请求</h3><ul><li><p>accept_new_sessions: 配置janus是否应该接受一个新的会话（当你任何时候想要清空一个janus实例使用这个非常方便）</p><ul><li><p>request:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;accept_new_sessions&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;accept&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>reponse</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzc&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;accept&quot;</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>list_sessions:列出现存的active状态的会话</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;list_sessions&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;z4a9ie1CZD97&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;z4a9ie1CZD97&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;sessions&quot;</span>: [</span><br><span class="line">        <span class="number">5861290772059172</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>destory_session: 销毁一个会话</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>:    <span class="string">&quot;destroy&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>:    <span class="string">&quot;l1Mrk00izyzr&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;session_id&quot;</span>: <span class="number">3086529275573380</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;session_id&quot;</span>: <span class="number">3086529275573380</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;l1Mrk00izyzr&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="句柄及webrtc相关的请求"><a href="#句柄及webrtc相关的请求" class="headerlink" title="句柄及webrtc相关的请求"></a>句柄及webrtc相关的请求</h3><ul><li><p>list_handles: 列出现存的active状态的ICE句柄</p><ul><li><p>url：<code>https://ip:port/admin/session_id</code></p></li><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;list_handles&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;ZBJomuxVRUyQ&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;session_id&quot;</span>: <span class="number">2548810000107482</span>,</span><br><span class="line">   <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;ZBJomuxVRUyQ&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;handles&quot;</span>: [</span><br><span class="line">      <span class="number">743792752849709</span></span><br><span class="line">   ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>handle_info: 列出特定ICE句柄的所有信息。如果将plugin_only变量值设置为true则仅返回插件相关的信息，webrtc信息及状态均不会被包含在返回信息中。</p><ul><li><p>url：<code>https://ip:port/admin/session_id/handle_id</code></p></li><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;handle_info&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;DwzOP5mrCmX6&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>response（video-room）</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;session_id&quot;</span>: <span class="number">2548810000107482</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;DwzOP5mrCmX6&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;handle_id&quot;</span>: <span class="number">743792752849709</span>,</span><br><span class="line">    <span class="attr">&quot;info&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;session_id&quot;</span>: <span class="number">2548810000107482</span>,</span><br><span class="line">        <span class="attr">&quot;session_last_activity&quot;</span>: <span class="number">152840675914</span>,</span><br><span class="line">        <span class="attr">&quot;session_timeout&quot;</span>: <span class="number">60</span>,</span><br><span class="line">        <span class="attr">&quot;session_transport&quot;</span>: <span class="string">&quot;janus.transport.http&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;handle_id&quot;</span>: <span class="number">743792752849709</span>,</span><br><span class="line">        <span class="attr">&quot;opaque_id&quot;</span>: <span class="string">&quot;videoroomtest-jDH6WBjAcyI4&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;loop-running&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">&quot;created&quot;</span>: <span class="number">152597708101</span>,</span><br><span class="line">        <span class="attr">&quot;current_time&quot;</span>: <span class="number">152852556490</span>,</span><br><span class="line">        <span class="attr">&quot;plugin&quot;</span>: <span class="string">&quot;janus.plugin.videoroom&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;plugin_specific&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;publisher&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;room&quot;</span>: <span class="number">1234</span>,</span><br><span class="line">            <span class="attr">&quot;id&quot;</span>: <span class="number">4406738697513809</span>,</span><br><span class="line">            <span class="attr">&quot;private_id&quot;</span>: <span class="number">1323301421</span>,</span><br><span class="line">            <span class="attr">&quot;display&quot;</span>: <span class="string">&quot;123&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;media&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;audio&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">&quot;audio_codec&quot;</span>: <span class="string">&quot;opus&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;video&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">&quot;video_codec&quot;</span>: <span class="string">&quot;vp8&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;data&quot;</span>: <span class="literal">false</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;bitrate&quot;</span>: <span class="number">128000</span>,</span><br><span class="line">            <span class="attr">&quot;audio-level-dBov&quot;</span>: <span class="number">97</span>,</span><br><span class="line">            <span class="attr">&quot;talking&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;hangingup&quot;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;destroyed&quot;</span>: <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;flags&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;got-offer&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;got-answer&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;negotiated&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;processing-offer&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;starting&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;ice-restart&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;ready&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;stopped&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;alert&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;trickle&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;all-trickles&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;resend-trickles&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;trickle-synced&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;data-channels&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;has-audio&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;has-video&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;new-datachan-sdp&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;rfc4588-rtx&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;cleaning&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;e2ee&quot;</span>: <span class="literal">false</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;agent-created&quot;</span>: <span class="number">152600228063</span>,</span><br><span class="line">        <span class="attr">&quot;ice-mode&quot;</span>: <span class="string">&quot;full&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;ice-role&quot;</span>: <span class="string">&quot;controlled&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;sdps&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;profile&quot;</span>: <span class="string">&quot;UDP/TLS/RTP/SAVPF&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;local&quot;</span>: <span class="string">&quot;sdp&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;remote&quot;</span>: <span class="string">&quot;sdp&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;queued-packets&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">&quot;streams&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">&quot;ready&quot;</span>: <span class="number">-1</span>,</span><br><span class="line">                <span class="attr">&quot;ssrc&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;audio&quot;</span>: <span class="number">997893997</span>,</span><br><span class="line">                    <span class="attr">&quot;video&quot;</span>: <span class="number">1527131261</span>,</span><br><span class="line">                    <span class="attr">&quot;video-rtx&quot;</span>: <span class="number">3707199999</span>,</span><br><span class="line">                    <span class="attr">&quot;audio-peer&quot;</span>: <span class="number">3279797068</span>,</span><br><span class="line">                    <span class="attr">&quot;video-peer&quot;</span>: <span class="number">1111535207</span>,</span><br><span class="line">                    <span class="attr">&quot;video-peer-rtx&quot;</span>: <span class="number">996540079</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;direction&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;audio-send&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">&quot;audio-recv&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">&quot;video-send&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">&quot;video-recv&quot;</span>: <span class="literal">true</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;codecs&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;audio-pt&quot;</span>: <span class="number">111</span>,</span><br><span class="line">                    <span class="attr">&quot;audio-codec&quot;</span>: <span class="string">&quot;opus&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;video-pt&quot;</span>: <span class="number">96</span>,</span><br><span class="line">                    <span class="attr">&quot;video-rtx-pt&quot;</span>: <span class="number">97</span>,</span><br><span class="line">                    <span class="attr">&quot;video-codec&quot;</span>: <span class="string">&quot;vp8&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;extensions&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;urn:ietf:params:rtp-hdrext:sdes:mid&quot;</span>: <span class="number">4</span>,</span><br><span class="line">                    <span class="attr">&quot;urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id&quot;</span>: <span class="number">10</span>,</span><br><span class="line">                    <span class="attr">&quot;urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id&quot;</span>: <span class="number">11</span>,</span><br><span class="line">                    <span class="attr">&quot;http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01&quot;</span>: <span class="number">3</span>,</span><br><span class="line">                    <span class="attr">&quot;urn:ietf:params:rtp-hdrext:ssrc-audio-level&quot;</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="attr">&quot;urn:3gpp:video-orientation&quot;</span>: <span class="number">13</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;bwe&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;twcc&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">&quot;twcc-ext-id&quot;</span>: <span class="number">3</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;nack-queue-ms&quot;</span>: <span class="number">200</span>,</span><br><span class="line">                <span class="attr">&quot;rtcp_stats&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;audio&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;base&quot;</span>: <span class="number">48000</span>,</span><br><span class="line">                        <span class="attr">&quot;rtt&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;lost&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;lost-by-remote&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;jitter-local&quot;</span>: <span class="number">1</span>,</span><br><span class="line">                        <span class="attr">&quot;jitter-remote&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;in-link-quality&quot;</span>: <span class="number">100</span>,</span><br><span class="line">                        <span class="attr">&quot;in-media-link-quality&quot;</span>: <span class="number">100</span>,</span><br><span class="line">                        <span class="attr">&quot;out-link-quality&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;out-media-link-quality&quot;</span>: <span class="number">0</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">&quot;video&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;base&quot;</span>: <span class="number">90000</span>,</span><br><span class="line">                        <span class="attr">&quot;rtt&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;lost&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;lost-by-remote&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;jitter-local&quot;</span>: <span class="number">3</span>,</span><br><span class="line">                        <span class="attr">&quot;jitter-remote&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;in-link-quality&quot;</span>: <span class="number">100</span>,</span><br><span class="line">                        <span class="attr">&quot;in-media-link-quality&quot;</span>: <span class="number">100</span>,</span><br><span class="line">                        <span class="attr">&quot;out-link-quality&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;out-media-link-quality&quot;</span>: <span class="number">0</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;components&quot;</span>: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">&quot;id&quot;</span>: <span class="number">1</span>,</span><br><span class="line">                        <span class="attr">&quot;state&quot;</span>: <span class="string">&quot;ready&quot;</span>,</span><br><span class="line">                        <span class="attr">&quot;connected&quot;</span>: <span class="number">152600440611</span>,</span><br><span class="line">                        <span class="attr">&quot;local-candidates&quot;</span>: [</span><br><span class="line">                            <span class="string">&quot;1 1 udp 2015363327 192.168.1.51 54605 typ host&quot;</span></span><br><span class="line">                        ],</span><br><span class="line">                        <span class="attr">&quot;remote-candidates&quot;</span>: [</span><br><span class="line">                            <span class="string">&quot;1755041049 1 udp 2122260223 192.168.74.1 51297 typ host generation 0 ufrag bTNl network-id 1&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;2530088836 1 udp 2122129151 192.168.1.106 51299 typ host generation 0 ufrag bTNl network-id 3&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;2272787581 1 udp 2122194687 172.16.100.1 51298 typ host generation 0 ufrag bTNl network-id 2&quot;</span></span><br><span class="line">                        ],</span><br><span class="line">                        <span class="attr">&quot;selected-pair&quot;</span>: <span class="string">&quot;192.168.1.51:54605 [host,udp] &lt;-&gt; 192.168.1.106:51299 [host,udp]&quot;</span>,</span><br><span class="line">                        <span class="attr">&quot;dtls&quot;</span>: &#123;</span><br><span class="line">                            <span class="attr">&quot;fingerprint&quot;</span>: <span class="string">&quot;2E:31:41:43:A9:AC:1F:58:AC:57:D7:15:6C:7E:DB:99:1D:13:58:4A:89:31:43:CB:F8:9F:97:26:2E:66:B9:76&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;remote-fingerprint&quot;</span>: <span class="string">&quot;CE:70:89:E8:0E:A0:F0:FC:42:7E:CB:75:54:29:C8:4A:A4:2D:C8:36:70:37:57:59:A8:AB:9D:62:19:A9:B6:A7&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;remote-fingerprint-hash&quot;</span>: <span class="string">&quot;sha-256&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;dtls-role&quot;</span>: <span class="string">&quot;active&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;dtls-state&quot;</span>: <span class="string">&quot;connected&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;retransmissions&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                            <span class="attr">&quot;valid&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                            <span class="attr">&quot;srtp-profile&quot;</span>: <span class="string">&quot;SRTP_AES128_CM_SHA1_80&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;ready&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                            <span class="attr">&quot;handshake-started&quot;</span>: <span class="number">152600440643</span>,</span><br><span class="line">                            <span class="attr">&quot;connected&quot;</span>: <span class="number">152600447955</span>,</span><br><span class="line">                            <span class="attr">&quot;sctp-association&quot;</span>: <span class="literal">false</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="attr">&quot;in_stats&quot;</span>: &#123;</span><br><span class="line">                            <span class="attr">&quot;audio_packets&quot;</span>: <span class="number">12606</span>,</span><br><span class="line">                            <span class="attr">&quot;audio_bytes&quot;</span>: <span class="number">775132</span>,</span><br><span class="line">                            <span class="attr">&quot;audio_bytes_lastsec&quot;</span>: <span class="number">3036</span>,</span><br><span class="line">                            <span class="attr">&quot;do_audio_nacks&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                            <span class="attr">&quot;video_packets&quot;</span>: <span class="number">7031</span>,</span><br><span class="line">                            <span class="attr">&quot;video_bytes&quot;</span>: <span class="number">1870792</span>,</span><br><span class="line">                            <span class="attr">&quot;video_bytes_lastsec&quot;</span>: <span class="number">6938</span>,</span><br><span class="line">                            <span class="attr">&quot;do_video_nacks&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                            <span class="attr">&quot;video_nacks&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                            <span class="attr">&quot;video_retransmissions&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                            <span class="attr">&quot;data_packets&quot;</span>: <span class="number">3</span>,</span><br><span class="line">                            <span class="attr">&quot;data_bytes&quot;</span>: <span class="number">2247</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="attr">&quot;out_stats&quot;</span>: &#123;</span><br><span class="line">                            <span class="attr">&quot;audio_packets&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                            <span class="attr">&quot;audio_bytes&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                            <span class="attr">&quot;audio_bytes_lastsec&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                            <span class="attr">&quot;audio_nacks&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                            <span class="attr">&quot;video_packets&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                            <span class="attr">&quot;video_bytes&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                            <span class="attr">&quot;video_bytes_lastsec&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                            <span class="attr">&quot;video_nacks&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                            <span class="attr">&quot;data_packets&quot;</span>: <span class="number">3</span>,</span><br><span class="line">                            <span class="attr">&quot;data_bytes&quot;</span>: <span class="number">2298</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>start_pcap: 开始将发送的RTP/RTCP包抓包保存成pcap文件</p><ul><li><p>url：<code>https://ip:port/admin/session_id/handle_id</code></p></li><li><p>request:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;start_pcap&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;YHBmWC0jO2ax&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;folder&quot;</span>: <span class="string">&quot;/root/&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;filename&quot;</span>: <span class="string">&quot;b.pcap&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;truncate&quot;</span>: <span class="number">0</span>                            <span class="comment">// 抓取多少包截断，0 不截断</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;YHBmWC0jO2ax&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>stop_pcap:停止抓包</p><ul><li><p>url：<code>https://ip:port/admin/session_id/handle_id</code></p></li><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;stop_pcap&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;40dHehG1RkxP&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;40dHehG1RkxP&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>start_text2pcap:和start_pcap请求一样，但是保存为text文件。上同，其中 start_pcap 改为 start_text2pcap</p></li><li><p>stop_text2pcap:停止text2pcap抓包。上同，其中 stop_pcap 不变</p></li><li><p>message_plugin:发送同步消息给插件。几乎所有插件都实现该请求用于优化该插件的资源管理。管理插件内容，建议查看对应插件提供的同步 api，如 <a href="https://zhuanlan.zhihu.com/p/150461418">janus的videoroom插件</a>。（注：在 postman有所有的使用示例）</p><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;message_plugin&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;plugin&quot;</span>: <span class="string">&quot;janus.plugin.videoroom&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;40dHehG1RkxP&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;request&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;request&quot;</span>: <span class="string">&quot;list&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;40dHehG1RkxP&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;response&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;videoroom&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;list&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">&quot;room&quot;</span>: <span class="number">1234</span>,</span><br><span class="line">                <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Demo Room&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;pin_required&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">&quot;is_private&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">&quot;max_publishers&quot;</span>: <span class="number">6</span>,</span><br><span class="line">                <span class="attr">&quot;bitrate&quot;</span>: <span class="number">128000</span>,</span><br><span class="line">                <span class="attr">&quot;fir_freq&quot;</span>: <span class="number">10</span>,</span><br><span class="line">                <span class="attr">&quot;require_pvtid&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">&quot;require_e2ee&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">&quot;notify_joining&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">&quot;audiocodec&quot;</span>: <span class="string">&quot;opus&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;videocodec&quot;</span>: <span class="string">&quot;vp8&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;opus_fec&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">&quot;record&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">&quot;lock_record&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">&quot;num_participants&quot;</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">&quot;audiolevel_ext&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">&quot;audiolevel_event&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">&quot;audio_active_packets&quot;</span>: <span class="number">100</span>,</span><br><span class="line">                <span class="attr">&quot;audio_level_average&quot;</span>: <span class="number">25</span>,</span><br><span class="line">                <span class="attr">&quot;videoorient_ext&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">&quot;playoutdelay_ext&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">&quot;transport_wide_cc_ext&quot;</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>handup_webrtc: 挂断特定ICE句柄的PeerConnection，结果类似与主动挂断某个用户</p><ul><li><p>url：<code>https://ip:port/admin/session_id/handle_id</code></p></li><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;hangup_webrtc&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;40dHehG1RkxP&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;session_id&quot;</span>: <span class="number">4537884414371202</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;40dHehG1RkxP&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>detach_handle:分离特定的句柄，和 janus API 的 detach 消息的功能一致。功能与 attach 相反</p><ul><li><p>url：<code>https://ip:port/admin/session_id/handle_id</code></p></li><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;detach_handle&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;40dHehG1RkxP&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;admin_secret&quot;</span>: <span class="string">&quot;janusoverlord&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;janus&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;session_id&quot;</span>: <span class="number">4537884414371202</span>,</span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span>: <span class="string">&quot;40dHehG1RkxP&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><ol><li><a href="https://zhuanlan.zhihu.com/p/150461418">janus的videoroom插件</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="janus" scheme="http://nikohpng.github.io/categories/janus/"/>
    
    
    <category term="janus-admin" scheme="http://nikohpng.github.io/tags/janus-admin/"/>
    
  </entry>
  
  <entry>
    <title>FFmpeg在Win编译并运行</title>
    <link href="http://nikohpng.github.io/2022/04/04/ffmpeg/setting_make/FFmpeg%E5%9C%A8Win%E7%BC%96%E8%AF%91%E5%B9%B6%E8%BF%90%E8%A1%8C/"/>
    <id>http://nikohpng.github.io/2022/04/04/ffmpeg/setting_make/FFmpeg%E5%9C%A8Win%E7%BC%96%E8%AF%91%E5%B9%B6%E8%BF%90%E8%A1%8C/</id>
    <published>2022-04-04T07:27:05.000Z</published>
    <updated>2022-04-04T08:31:09.292Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>本人选择编译的 FFmpeg 不是在 Linux 环境下面，也不是在 Win 环境下面的模拟 Linux 环境（例如：mgwin、cygwin）。</p><p>使用 vs 搭建 FFmpeg，其主要目的是为了方便调试与学习。本人较为喜欢 vs 的调试。</p><p>采用的 <a href="https://github.com/ShiftMediaProject/FFmpeg">FFmpeg</a> 是专门为 Win 环境做了适配。</p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><table><thead><tr><th>环境名</th><th>版本</th></tr></thead><tbody><tr><td>WIN</td><td>WIN10</td></tr><tr><td>VS</td><td>vs2017</td></tr></tbody></table><h2 id="基础的搭建"><a href="#基础的搭建" class="headerlink" title="基础的搭建"></a>基础的搭建</h2><p>关于最基本的搭建内容有很多文章都有关于这方面的叙述，此处我将只会叙述一个大概主要的安装流程。</p><p>至于其中更详细内容可以参考下面的引用</p><ul><li>第一步：创建文件夹目录，目录结构如下所示  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- msvc (OutputDir)　　　　　　　　　　　　　 　　</span><br><span class="line">- source　　　　　　　　　　　　　　　　　 　　　</span><br><span class="line">　　- FFmpeg 　　　　　　　　　　　　　　　　　　</span><br><span class="line">　　- ..Any other libraries source code..</span><br></pre></td></tr></table></figure></li><li>第二步：使用 FFmpeg 项目目录下面的 project_get_dependencies.bat 脚本运行并获取依赖项目。<blockquote><p>注意：此处由于国内的原因，可以采用代理或者直接网上下载的方式获取，建议采用脚本，方便更新</p></blockquote></li><li>第三步：下载额外依赖的头文件到 msvc 的 include 的目录中<ul><li><a href="https://www.khronos.org/registry/OpenGL/api/GL/">下载</a> opengl 的 glext.h 和 wglext.h  到  “ msvc/include/gl/* “</li><li><a href="https://www.khronos.org/registry/EGL/api/KHR/">下载</a> opengl 的 khrplatform.h 到 “ msvc/include/KHR/* “</li><li><a href="https://github.com/FFmpeg/nv-codec-headers">下载</a>  nv-codec-headers 项目的 “include” 文件夹下的内容到  “ msvc/include/* “</li><li><a href="https://github.com/GPUOpen-LibrariesAndSDKs/AMF">下载</a> AMF 项目的  “amf/public/include” 文件夹下的内容到  “ msvc/include/AMF/* “</li></ul></li><li>第四步：安装 <a href="https://github.com/ShiftMediaProject/VSNASM/releases/latest">nasm</a> 与 <a href="https://github.com/ShiftMediaProject/VSYASM/releases">yasm</a><br>。将内容下载到本地后解压到 msvc 目录并分别使用管理员权限执行其中的 install_script.bat 脚本</li><li>第五步：使用 visual studio 打开 <strong>FFmpeg/SMP/ffmpeg_desp.sln</strong> 项目文件</li></ul><p>以上是编译时候的主要步骤，下面是在此过程中所遇到的问题以及解决方案</p><h2 id="问题与解决"><a href="#问题与解决" class="headerlink" title="问题与解决"></a>问题与解决</h2><ul><li><p>关于依赖的缺失：我这边由于是新项目，网络上的很多描述没涉及到其中缺失的一些项目。</p><blockquote><p>解决方案：在 ShiftMediaProject 这个 github 账号里面将缺失的项目都下载或者克隆到 source 目录下面，然后重启 vs 即可</p></blockquote></li><li><p>关于 h264 与 h265 项目无法编译：在保证 yasm 与 nasm 正确的情况下，仍然无法编译，编译器一直提示缺少 win sdk8.1</p><blockquote><p>解决方案：通过 vs intall 下载安装好 sdk8.1 的内容</p></blockquote></li><li><p>关于新项目无法加载 uwp 结尾的项目问题：此问题是本地项目中没有安装 uwp 的库</p><blockquote><p>解决方案：同样可以通过安装 uwp 的内容解决，实际情况以个人开发者的环境为准</p></blockquote></li><li><p>关于一些项目缺失某些头文件：注意查看情况，缺失头文件一般有两种情况。一种是这个项目的依赖项目编译失败，查看方式就是去 msvc/include 下面看是否有这个依赖项目的头文件<br>；第二种情况是这个项目依赖的 submodule 没有下载成功（例如：gnulib），查看方式是报错的时候会指向具体的某个编译的项目。</p><blockquote><p>解决方案：如果是 submodule ，那么可以使用 <code>git submodule update</code> 来获取子项目，一直获取失败的话可以直接下载后拷贝进去。如果是<br>项目缺失的直接按照第一条的解决方式即可解决 </p></blockquote></li></ul><p>最后，总结下。如果缺失某些头文件，请仔细思考是否是该项目的依赖项目编译失败。直接单独编译该项目或指明的依赖项目就可以准确定位了。</p><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p><a href="https://www.cnblogs.com/BensonLaur/p/10989115.html">使用 VS2015 编译并调试 ffmpeg</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="FFmpeg" scheme="http://nikohpng.github.io/categories/FFmpeg/"/>
    
    
    <category term="make" scheme="http://nikohpng.github.io/tags/make/"/>
    
  </entry>
  
</feed>
