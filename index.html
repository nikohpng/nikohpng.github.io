<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>hpng</title><meta name="description" content="卖掉梦想，不一定换来柴米油盐！"><meta name="author" content="hpng"><meta name="copyright" content="hpng"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://nikohpng.github.io/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta property="og:type" content="website"><meta property="og:title" content="hpng"><meta property="og:url" content="http://nikohpng.github.io/"><meta property="og:site_name" content="hpng"><meta property="og:description" content="卖掉梦想，不一定换来柴米油盐！"><meta property="og:image" content="http://nikohpng.github.io/img/100.jpg"><meta property="article:published_time" content="2023-06-03T03:03:38.332Z"><meta property="article:modified_time" content="2023-06-03T03:03:38.332Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.0.2',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isSidebar: false,
  postUpdate: '2023-06-03 11:03:38'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 5.0.2"><link rel="alternate" href="/atom.xml" title="hpng" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="/img/100.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">54</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">45</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">20</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div></div></div><div id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(/img/159.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">hpng</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="site-info"><h1 id="site_title">hpng</h1><div id="site_subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/nikohpng" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:heping050414@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll_down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout_page" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2023/04/27/freeswitch/FreeSWITCH%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90/" title="FreeSWITCH问题分析">     <img class="post_bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FreeSWITCH问题分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/04/27/freeswitch/FreeSWITCH%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90/" title="FreeSWITCH问题分析">FreeSWITCH问题分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-04-27T12:47:49.000Z" title="发表于 2023-04-27 20:47:49">2023-04-27</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/FreeSWTICH/">FreeSWTICH</a></span></div><div class="content">本文主要讲解在实际运维过程中容易出现的问题现象以及导致其出现问题的根本原因，可能附带有解决方法
30s挂断呼叫通没问题，但是会出现 30s 挂断。一般原因有以下几个方面：

外网端口与内网端口没有一对一映射：端口错误，导致客户端与 FS 的沟通出现网络无法连接问题，可能是 ACK 问题。
解决方案：将接口一对一映射



FS与opensip使用tls对接时，2分钟 tcp 断连opensips 本身有个参数 tcp_connection_lifetime 用于控制 tcp 的存活时长，此存活时长只能通过与服务端发送数据来延长时间，无法通过 tcp 本身的 keepalive 来进行保活。
最后，必须通过 fs 端发送 option 来延长 tcp 的存活时间。想要实现在通话中发送 option，那么必须使用 gateway ，并在 gateway 中配置 ping 来发送 option。
其中，option 存在问题还没开始通话就有 option 进行发送，其中的端口与通话的端口有什么关系呢？根据抓包发现：当前没通话，有新的呼叫创建情况下，有option，那就直接用option的端口 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2023/04/25/webrtc/WebRTC%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90%E5%86%85%E5%AE%B9/" title="WebRTC问题分析内容">     <img class="post_bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WebRTC问题分析内容"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/04/25/webrtc/WebRTC%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90%E5%86%85%E5%AE%B9/" title="WebRTC问题分析内容">WebRTC问题分析内容</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-04-25T12:41:53.000Z" title="发表于 2023-04-25 20:41:53">2023-04-25</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/WebRTC/">WebRTC</a></span></div><div class="content">WebRTC 的问题分析分析主要记录一些使用 WebRTC 过程中出现的问题，并且当前没有成体系的内容用于总结，简单的零散分析
WebRTC 的 oncandidate 时候失败，导致 setLocalDescription 耗时增加
问题：如标题所诉，由于在收集本地网络环境的，一些网卡（虚拟网卡等）的 ip，不具有连接网络的能力，导致在收集 IP 的时候会出现失败。
解决方案：监听来自 oncandidate 的事件，检测到有 relay 或 srly 的就可以直接调用 complete  1234567session.on(&quot;icecandidate&quot;, function (event) &#123;    if (event.candidate.type === &quot;srflx&quot; &amp;&amp;        event.candidate.relatedAddress !== null &amp;&amp;        event.candidate.relatedPort !== null) &#123;        event ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2023/03/30/webrtc/WebRTC%E6%BA%90%E7%A0%81%E4%B8%AD%E6%96%87%E4%BB%B6%E7%9A%84%E4%BD%9C%E7%94%A8/" title="WebRTC源码中文件的作用">     <img class="post_bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WebRTC源码中文件的作用"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/webrtc/WebRTC%E6%BA%90%E7%A0%81%E4%B8%AD%E6%96%87%E4%BB%B6%E7%9A%84%E4%BD%9C%E7%94%A8/" title="WebRTC源码中文件的作用">WebRTC源码中文件的作用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T13:03:54.000Z" title="发表于 2023-03-30 21:03:54">2023-03-30</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/WebRTC/">WebRTC</a></span></div><div class="content">本文主要讲解在 WebRTC 中一些文件的作用，并且其用途在编译过程中的一些用途。当然这些文件主要是一些配置文件，不包括源码文件
src 中源码
BUILD.gn：本文件主要包含了各种需要编译的各种源码，其中配置了编译 SDK 时，需要编译的源码。
DEPS：主要包含的是一些依赖文件，例如：openh264、ffmpeg等这类依赖文件

</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2023/03/30/webrtc/WebRTC%E5%9C%A8Mac%E4%B8%AD%E7%9A%84%E7%BC%96%E8%AF%91/" title="WebRTC在Mac中的编译">     <img class="post_bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WebRTC在Mac中的编译"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/webrtc/WebRTC%E5%9C%A8Mac%E4%B8%AD%E7%9A%84%E7%BC%96%E8%AF%91/" title="WebRTC在Mac中的编译">WebRTC在Mac中的编译</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T12:26:21.000Z" title="发表于 2023-03-30 20:26:21">2023-03-30</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/WebRTC/">WebRTC</a></span></div><div class="content">webrtc 在 mac 编译 Mac 与 IOS本文将会讲解在 mac 中从拉取代码到打包成 xcframework 的所有步骤，包中包括了ios 与 mac 的所有包。
设置代理编译 WebRTC 全程需要代理软件，所以建议设置好代理软件。
12export http_porxy&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1:21087&quot;export https_porxy&#x3D;&quot;https:&#x2F;&#x2F;127.0.0.1:21087&quot;

注意：即使在 MAC 中开启全局代理，仍然需要设置代理。本人编译时，没配置这个有时候出现无法下载外网资源，即使开了全局代理也没用。

安装 depot_toolsdepot_tools 是一套 Google 用来编译 WebRTC 的构建工具，获取 depot_tools 前，请先开启 VPN。
下载 depot_tools 解压到某个目录，然后配置系统环境
1export PATH=$PWD/depot_tools:$PATH

获取源代码获取源代码不能使用官网的源代 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2023/03/30/webrtc/WebRTC%E5%9C%A8ubuntu%E4%B8%AD%E7%BC%96%E8%AF%91android/" title="WebRTC在ubuntu中编译android">     <img class="post_bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WebRTC在ubuntu中编译android"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/webrtc/WebRTC%E5%9C%A8ubuntu%E4%B8%AD%E7%BC%96%E8%AF%91android/" title="WebRTC在ubuntu中编译android">WebRTC在ubuntu中编译android</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T11:59:43.000Z" title="发表于 2023-03-30 19:59:43">2023-03-30</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/WebRTC/">WebRTC</a></span></div><div class="content">本文将会讲解在 ubuntu 中拉取代码 flutter 中的 WebRTC 并打包成 android 可以使用的 aar。

注意：编译 Android 的时候，建议在国外的服务器上编译，否则可能出现无法获取各种依赖文件的问题

系统选择注意：在编译 android 端的 WebRTC 的时候必须选择 ubuntu，其中最好是采用以下版本
123456Ubuntu 14.04 LTS (trusty with EoL April 2022）Ubuntu 16.04 LTS (xenial with EoL April 2024）Ubuntu 18.04 LTS (bionic with EoL April 2028）Ubuntu 20.04 LTS (focal with Eol April 2030)Ubuntu 20.10 (groovy) Debian 10 (buster) or later
如果不是，那么可能遇到一些环境问题，需要手动修改源码
设置代理拉取 WebRTC 全程需要代理软件，所以请先设置好代理软件
12export http_proxy=http://192. ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2023/03/27/freeswitch/FreeSWITCH%E4%B8%ADxml-rpc%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/" title="FreeSWITCH中xml_rpc的使用技巧">     <img class="post_bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FreeSWITCH中xml_rpc的使用技巧"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/27/freeswitch/FreeSWITCH%E4%B8%ADxml-rpc%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/" title="FreeSWITCH中xml_rpc的使用技巧">FreeSWITCH中xml_rpc的使用技巧</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-27T13:12:18.000Z" title="发表于 2023-03-27 21:12:18">2023-03-27</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/FreeSWTICH/">FreeSWTICH</a></span></div><div class="content">本文主要讲解在实际开发中，可能遇到的使用 xml_rpc 命令过程中的一些内容
查询 api 的命令查看 xml_rpc 中的命令通过如下方式即可，在浏览器中打开如下链接：http://127.0.0.1:8080/webapi/help
调试命令
通过 curl 调用 lua 程序，并传递参数，其中空格需要用 %20 替换  script1curl --user yw:yw@123 http://127.0.0.1:7652/webapi/luarun?call_phone.lua%20var


</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2023/03/23/freeswitch/FreeSWITCH%E4%B8%ADmod%E7%9A%84%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96/" title="FreeSWITCH中mod的状态变化">     <img class="post_bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FreeSWITCH中mod的状态变化"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/23/freeswitch/FreeSWITCH%E4%B8%ADmod%E7%9A%84%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96/" title="FreeSWITCH中mod的状态变化">FreeSWITCH中mod的状态变化</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-23T13:05:32.000Z" title="发表于 2023-03-23 21:05:32">2023-03-23</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/FreeSWTICH/">FreeSWTICH</a></span></div><div class="content">本文主要讲述在 endpoint 的 mod 在启动关闭与呼叫、挂断等其中的状态变化内容
mod 的启动关闭此处的状态变化最为简单，只有两个回调函数，分别如下所示：
123SWITCH_MODULE_LOAD_FUNCTION(mod_test_load);SWITCH_MODULE_SHUTDOWN_FUNCTION(mod_test_shutdown);SWITCH_MODULE_DEFINITION(mod_test, mod_test_load, mod_test_shutdown, NULL); // mod_test_runtime

一般 runtime 都没用，暂时不明白作用。有个这个定义后，再实现相应的启动关闭函数，如下所示：
1234567SWITCH_MODULE_LOAD_FUNCTION(mod_test_load) &#123;    /// 你想要实现内容，宏展开后有如下参数    /// switch_loadable_module_interface_t **module_interface, switch_memory_pool_t *pool&#1 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2023/03/22/freeswitch/FreeSWITCH%E5%9C%A8Linux%E4%B8%8B%E7%BC%96%E8%AF%91%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91/" title="FreeSWITCH在Linux下编译模块编译">     <img class="post_bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FreeSWITCH在Linux下编译模块编译"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/22/freeswitch/FreeSWITCH%E5%9C%A8Linux%E4%B8%8B%E7%BC%96%E8%AF%91%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91/" title="FreeSWITCH在Linux下编译模块编译">FreeSWITCH在Linux下编译模块编译</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-22T13:21:15.000Z" title="发表于 2023-03-22 21:21:15">2023-03-22</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/FreeSWTICH/">FreeSWTICH</a></span></div><div class="content">本文主要讲解在 Linux 环境下编译 FreeSWITCH 模块时的配置以及所遇到的问题
Linux 下编译 MOD 的配置</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2023/03/21/codec/opus%E7%BC%96%E8%A7%A3%E7%A0%81%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D/" title="opus编解码相关介绍">     <img class="post_bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="opus编解码相关介绍"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/21/codec/opus%E7%BC%96%E8%A7%A3%E7%A0%81%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D/" title="opus编解码相关介绍">opus编解码相关介绍</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-21T13:04:00.000Z" title="发表于 2023-03-21 21:04:00">2023-03-21</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/codec/">codec</a></span></div><div class="content">本文主要讲解在实际开发中遇到的关于Opus的编解码问题
SDP中OPUS介绍在 SDP 中，任何其它采样率都不起作用，在 rtp 传输时默认采用 48000, 可以在 rfc7587 Section 4.1 中查看如下所示：
1234567Opus supports 5 different audio bandwidths, which can be adjustedduring a stream.  The RTP timestamp is incremented with a 48000 Hzclock rate for all modes of Opus and all sampling rates.  The unitfor the timestamp is samples per single (mono) channel.  The RTPtimestamp corresponds to the sample time of the first encoded samplein the encoded frame.  For data encoded with sampli ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2023/03/20/tools/wireshark%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E9%9F%B3%E8%A7%86%E9%A2%91/" title="wireshark抓包分析音视频">     <img class="post_bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="wireshark抓包分析音视频"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/20/tools/wireshark%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E9%9F%B3%E8%A7%86%E9%A2%91/" title="wireshark抓包分析音视频">wireshark抓包分析音视频</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-20T11:36:01.000Z" title="发表于 2023-03-20 19:36:01">2023-03-20</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/capture/">capture</a></span></div><div class="content">本文主要记录通过 wireshark 抓音视频的分析方法
win上抓包分析window上面主要以导入 lua 解析文件为主

在 wireshark 安装目录下面，有个 init.lua， 在其中加入如下所示内容：
  1dofile(USER_DIR..filename)
导入成功后，重启wireshark， 在工具栏中就会出现导入的 lua 文件名字。

随后到 编辑-&gt;首选项-&gt;协议 中根据需要解码的音视频，填写 payload 值

最后，当获取到 *.pcap 文件后，点击 工具-&gt;lua的名字 运行即可


linux上抓包分析opus此处步骤仅用于在 linux 上，通过命令行的形式分析 opus

获取 python 脚本，opus_stream_tool
tcpdump -i eth0 port 1234 -w in.pcap
tshark -x -r in.pcap -Y “udp.srcport == myport” | cut -d “ “ -f 1-20 &gt; tmp.txt
hex_to_opus.py -x tmp.txt –reco ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/img/100.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">hpng</div><div class="author-info__description">卖掉梦想，不一定换来柴米油盐！</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives"><div class="headline">文章</div><div class="length_num">54</div></a></div><div class="card-info-data-item is-center">      <a href="/tags"><div class="headline">标签</div><div class="length_num">45</div></a></div><div class="card-info-data-item is-center"><a href="/categories"><div class="headline">分类</div><div class="length_num">20</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/nikohpng"><i class="fab fa-github"></i><span>查看我</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/nikohpng" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:heping050414@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">blog主要用于分享我在生活与工作中学习到的知识</div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-recent-item"><div class="aside-recent-post"><a class="aside-post-cover" href="/2023/04/27/freeswitch/FreeSWITCH%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90/" title="FreeSWITCH问题分析"><img class="aside-post-bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FreeSWITCH问题分析"/></a><div class="aside-post-info"><a class="aside-post-title" href="/2023/04/27/freeswitch/FreeSWITCH%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90/" title="FreeSWITCH问题分析">FreeSWITCH问题分析</a><time class="aside-post_meta post-meta-date" datetime="2023-04-27T12:47:49.000Z" title="发表于 2023-04-27 20:47:49">2023-04-27</time></div></div><div class="aside-recent-post"><a class="aside-post-cover" href="/2023/04/25/webrtc/WebRTC%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90%E5%86%85%E5%AE%B9/" title="WebRTC问题分析内容"><img class="aside-post-bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WebRTC问题分析内容"/></a><div class="aside-post-info"><a class="aside-post-title" href="/2023/04/25/webrtc/WebRTC%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90%E5%86%85%E5%AE%B9/" title="WebRTC问题分析内容">WebRTC问题分析内容</a><time class="aside-post_meta post-meta-date" datetime="2023-04-25T12:41:53.000Z" title="发表于 2023-04-25 20:41:53">2023-04-25</time></div></div><div class="aside-recent-post"><a class="aside-post-cover" href="/2023/03/30/webrtc/WebRTC%E6%BA%90%E7%A0%81%E4%B8%AD%E6%96%87%E4%BB%B6%E7%9A%84%E4%BD%9C%E7%94%A8/" title="WebRTC源码中文件的作用"><img class="aside-post-bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WebRTC源码中文件的作用"/></a><div class="aside-post-info"><a class="aside-post-title" href="/2023/03/30/webrtc/WebRTC%E6%BA%90%E7%A0%81%E4%B8%AD%E6%96%87%E4%BB%B6%E7%9A%84%E4%BD%9C%E7%94%A8/" title="WebRTC源码中文件的作用">WebRTC源码中文件的作用</a><time class="aside-post_meta post-meta-date" datetime="2023-03-30T13:03:54.000Z" title="发表于 2023-03-30 21:03:54">2023-03-30</time></div></div><div class="aside-recent-post"><a class="aside-post-cover" href="/2023/03/30/webrtc/WebRTC%E5%9C%A8Mac%E4%B8%AD%E7%9A%84%E7%BC%96%E8%AF%91/" title="WebRTC在Mac中的编译"><img class="aside-post-bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WebRTC在Mac中的编译"/></a><div class="aside-post-info"><a class="aside-post-title" href="/2023/03/30/webrtc/WebRTC%E5%9C%A8Mac%E4%B8%AD%E7%9A%84%E7%BC%96%E8%AF%91/" title="WebRTC在Mac中的编译">WebRTC在Mac中的编译</a><time class="aside-post_meta post-meta-date" datetime="2023-03-30T12:26:21.000Z" title="发表于 2023-03-30 20:26:21">2023-03-30</time></div></div><div class="aside-recent-post"><a class="aside-post-cover" href="/2023/03/30/webrtc/WebRTC%E5%9C%A8ubuntu%E4%B8%AD%E7%BC%96%E8%AF%91android/" title="WebRTC在ubuntu中编译android"><img class="aside-post-bg" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WebRTC在ubuntu中编译android"/></a><div class="aside-post-info"><a class="aside-post-title" href="/2023/03/30/webrtc/WebRTC%E5%9C%A8ubuntu%E4%B8%AD%E7%BC%96%E8%AF%91android/" title="WebRTC在ubuntu中编译android">WebRTC在ubuntu中编译android</a><time class="aside-post_meta post-meta-date" datetime="2023-03-30T11:59:43.000Z" title="发表于 2023-03-30 19:59:43">2023-03-30</time></div></div></div></div></div><div class="card-widget card-categories"><div class="card-content"><div class="item-headline"><i class="fas fa-folder-open"></i><span>分类</span></div><ul class="card-category-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/ES6/"><span class="card-category-list-name">ES6</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/FFmpeg/"><span class="card-category-list-name">FFmpeg</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/FreeSWTICH/"><span class="card-category-list-name">FreeSWTICH</span><span class="card-category-list-count">9</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Shell/"><span class="card-category-list-name">Shell</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/WebRTC/"><span class="card-category-list-name">WebRTC</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/c/"><span class="card-category-list-name">c</span><span class="card-category-list-count">15</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/capture/"><span class="card-category-list-name">capture</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/codec/"><span class="card-category-list-name">codec</span><span class="card-category-list-count">1</span></a></li>
            <li class="card-category-list-item more is-center"><a class="card-category-list-link-more" href="/categories">
                <span>查看更多</span><i class="fas fa-angle-right"></i></a></li>           
            </ul></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href='/tags/FreeSWITCH%E6%BA%90%E7%A0%81/' style='font-size:21px; color:rgb(197, 81, 110)'>FreeSWITCH源码</a><a href='/tags/IO/' style='font-size:16px; color:rgb(7, 36, 4)'>IO</a><a href='/tags/Question/' style='font-size:19px; color:rgb(197, 45, 74)'>Question</a><a href='/tags/Source/' style='font-size:19px; color:rgb(186, 2, 116)'>Source</a><a href='/tags/WebRTC%E7%BC%96%E8%AF%91/' style='font-size:20px; color:rgb(153, 74, 2)'>WebRTC编译</a><a href='/tags/attribute/' style='font-size:21px; color:rgb(64, 24, 20)'>attribute</a><a href='/tags/bash/' style='font-size:18px; color:rgb(30, 49, 121)'>bash</a><a href='/tags/c-release/' style='font-size:17px; color:rgb(25, 57, 120)'>c_release</a><a href='/tags/channels/' style='font-size:20px; color:rgb(109, 81, 189)'>channels</a><a href='/tags/command/' style='font-size:21px; color:rgb(137, 88, 1)'>command</a><a href='/tags/demo/' style='font-size:20px; color:rgb(132, 13, 127)'>demo</a><a href='/tags/eureka/' style='font-size:17px; color:rgb(40, 200, 6)'>eureka</a><a href='/tags/event/' style='font-size:17px; color:rgb(73, 8, 90)'>event</a><a href='/tags/fork/' style='font-size:21px; color:rgb(199, 161, 144)'>fork</a><a href='/tags/hexo/' style='font-size:19px; color:rgb(36, 47, 41)'>hexo</a><a href='/tags/janus-admin/' style='font-size:18px; color:rgb(164, 160, 6)'>janus-admin</a><a href='/tags/log/' style='font-size:18px; color:rgb(200, 47, 195)'>log</a><a href='/tags/make/' style='font-size:17px; color:rgb(176, 151, 37)'>make</a><a href='/tags/maven/' style='font-size:20px; color:rgb(14, 135, 116)'>maven</a><a href='/tags/mod/' style='font-size:16px; color:rgb(35, 159, 36)'>mod</a><a href='/tags/mybatis/' style='font-size:20px; color:rgb(85, 8, 89)'>mybatis</a><a href='/tags/opus/' style='font-size:21px; color:rgb(167, 35, 64)'>opus</a><a href='/tags/opus%E3%80%81h264/' style='font-size:17px; color:rgb(139, 194, 52)'>opus、h264</a><a href='/tags/pom/' style='font-size:16px; color:rgb(111, 52, 42)'>pom</a><a href='/tags/signal/' style='font-size:18px; color:rgb(166, 199, 148)'>signal</a><a href='/tags/socket/' style='font-size:19px; color:rgb(83, 193, 125)'>socket</a><a href='/tags/spring-boot%E6%BA%90%E7%A0%81/' style='font-size:18px; color:rgb(80, 193, 71)'>spring boot源码</a><a href='/tags/springcloud/' style='font-size:20px; color:rgb(18, 118, 114)'>springcloud</a><a href='/tags/tomcat/' style='font-size:16px; color:rgb(94, 120, 52)'>tomcat</a><a href='/tags/win/' style='font-size:18px; color:rgb(98, 180, 79)'>win</a><a href='/tags/xml-rpc/' style='font-size:16px; color:rgb(99, 178, 199)'>xml_rpc</a><a href='/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/' style='font-size:20px; color:rgb(38, 29, 169)'>位运算</a><a href='/tags/%E4%BE%9D%E8%B5%96/' style='font-size:18px; color:rgb(105, 139, 196)'>依赖</a><a href='/tags/%E5%85%B3%E9%94%AE%E5%AD%97/' style='font-size:20px; color:rgb(168, 38, 189)'>关键字</a><a href='/tags/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/' style='font-size:20px; color:rgb(140, 15, 13)'>内存分配</a><a href='/tags/%E5%87%BD%E6%95%B0/' style='font-size:19px; color:rgb(21, 167, 91)'>函数</a><a href='/tags/%E5%8F%98%E9%87%8F/' style='font-size:17px; color:rgb(158, 26, 129)'>变量</a><a href='/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/' style='font-size:20px; color:rgb(63, 191, 81)'>字符串</a><a href='/tags/%E6%95%B0%E7%BB%84/' style='font-size:18px; color:rgb(161, 135, 94)'>数组</a><a href='/tags/%E6%96%AD%E8%A8%80/' style='font-size:20px; color:rgb(153, 90, 163)'>断言</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">April 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">March 2023</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">January 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span class="card-archive-list-date">May 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/04/"><span class="card-archive-list-date">April 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/03/"><span class="card-archive-list-date">March 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/01/"><span class="card-archive-list-date">January 2022</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">June 2021</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item more is-center"><a class="card-archive-list-link-more" href="/archives">
              <span>查看更多</span><i class="fas fa-angle-right"  ></i></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="webinfo-article-name">文章数目 :</div><div class="webinfo-article-count">54</div></div><div class="webinfo-item">      <div class="webinfo-site-uv-name">本站访客数 :</div><div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="webinfo-site-name">本站总访问量 :</div><div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div></div></div></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By hpng</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a><br>
<img src="https://www.hepng.cool/images/beian.png">
<a href="http://beian.miit.gov.cn/"  style="color:#f72b07" target="_blank">蜀ICP备20025047号</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  $.getJSON('https://v1.hitokoto.cn', function (data) {
    if (false) {
      var from = '出自 ' + data.from
      var sub = "".length == 0 ? new Array() : "".split(',')
      var both = sub.unshift(data.hitokoto, from)
      var typed = new Typed('#subtitle', {
        strings: sub,
        startDelay: 300,
        typeSpeed: 150,
        loop: true,
        backSpeed: 50,
      })
    } else {
      document.getElementById('subtitle').innerHTML = data.hitokoto
    }
  })
}

if (false) {
  if (typeof Typed === 'function') subtitleType()
  else $.getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js', subtitleType)
} else {
  subtitleType()
}
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>